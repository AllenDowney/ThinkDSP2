
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4. Noise &#8212; Think DSP 2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap04';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Autocorrelation" href="chap05.html" />
    <link rel="prev" title="3. Non-Periodic Signals" href="chap03.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Think DSP 2</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    ThinkDSP
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Front Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chap00.html">Preface</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chap01.html">1. Sounds and signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap02.html">2. Harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">3. Non-Periodic Signals</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap05.html">5. Autocorrelation</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap06.html">6. Discrete Cosine Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">7. Discrete Fourier Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap08.html">8. Filtering and Convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap09.html">9. Differentiation and Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap10.html">10. LTI Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap11.html">11. Modulation and Sampling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cacophony.html">Cacophony for the whole family</a></li>
<li class="toctree-l1"><a class="reference internal" href="dft_example.html">Implementing DFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourth_wave.html">In Search of the Fourth Wave</a></li>
<li class="toctree-l1"><a class="reference internal" href="phase.html">ThinkDSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="pink_noise.html">Generating Pink Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="saxophone.html">ThinkDSP</a></li>

<li class="toctree-l1"><a class="reference internal" href="voss.html">ThinkDSP</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/AllenDowney/ThinkDSP2/tree/main" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chap04.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Noise</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#uncorrelated-noise">4.1. Uncorrelated Noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrated-spectrum">4.2. Integrated Spectrum</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brownian-noise">4.3. Brownian Noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pink-noise">4.4. Pink Noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-noise">4.5. Gaussian Noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">4.6. Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-1">4.6.1. Exercise 4.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-1-continued">4.6.2. Exercise 4.1 (continued)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-2">4.6.3. Exercise 4.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-3">4.6.4. Exercise 4.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-4">4.6.5. Exercise 4.4</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>The second edition of <em>Think DSP</em> is not for sale yet, but if you would like to support this project, you can <a class="reference external" href="https://buymeacoffee.com/allendowney">buy me a coffee</a>.</p>
<section id="noise">
<span id="chapter-noise"></span><h1><span class="section-number">4. </span>Noise<a class="headerlink" href="#noise" title="Link to this heading">#</a></h1>
<p>In English, “noise” means an unwanted or unpleasant sound.
In the context of signal processing, it has two different senses:</p>
<ol class="arabic simple">
<li><p>As in English, it can mean an unwanted signal of any kind.
If two signals interfere with each other, each signal would consider the other to be noise.</p></li>
<li><p>“Noise” also refers to a signal that contains components at many frequencies, so it lacks the harmonic structure of the periodic signals we saw in previous chapters.</p></li>
</ol>
<p>This chapter is about the second kind.</p>
<p><a class="reference external" href="https://colab.research.google.com/github/AllenDowney/ThinkDSP2/blob/main/soln/chap04.ipynb">Click here to run this notebook on Colab</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">importlib</span><span class="o">,</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s2">&quot;imp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">importlib</span>

<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell tag_remove-print docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download thinkdsp.py</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">basename</span><span class="p">,</span> <span class="n">exists</span>

<span class="k">def</span><span class="w"> </span><span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">urllib.request</span><span class="w"> </span><span class="kn">import</span> <span class="n">urlretrieve</span>
        <span class="n">local</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Downloaded &#39;</span> <span class="o">+</span> <span class="n">local</span><span class="p">)</span>
        
<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkDSP2/raw/main/soln/thinkdsp.py&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell tag_remove-print docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">thinkdsp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">decorate_time</span><span class="p">,</span> <span class="n">decorate_freq</span><span class="p">,</span> <span class="n">decorate_power</span><span class="p">,</span> <span class="n">decorate_gram</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="uncorrelated-noise">
<span id="section-uncorrelated-noise"></span><h2><span class="section-number">4.1. </span>Uncorrelated Noise<a class="headerlink" href="#uncorrelated-noise" title="Link to this heading">#</a></h2>
<p>The simplest way to understand noise is to generate it, and the simplest kind to generate is uncorrelated uniform noise (UU noise).
“Uniform” means the signal contains random values from a uniform distribution; that is, every value in the range is equally likely.
“Uncorrelated” means that the values are independent; that is, knowing one value provides no information about the others.</p>
<p>Here’s a class that represents UU noise:</p>
<!-- #endregion --><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">Noise</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UncorrelatedUniformNoise</span><span class="p">(</span><span class="n">Noise</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="p">):</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">amp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">amp</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ys</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">UncorrelatedUniformNoise</span></code> inherits from <code class="docutils literal notranslate"><span class="pre">_Noise</span></code>, which inherits from <code class="docutils literal notranslate"><span class="pre">Signal</span></code>.</p>
<p>As usual, the evaluate function takes <code class="docutils literal notranslate"><span class="pre">ts</span></code>, the times when the signal should be evaluated.
It uses <code class="docutils literal notranslate"><span class="pre">np.random.uniform</span></code>, which generates values from a uniform distribution.
In this example, the values are in the range between <code class="docutils literal notranslate"><span class="pre">-amp</span></code> to <code class="docutils literal notranslate"><span class="pre">amp</span></code>.</p>
<p>The following example generates UU noise with duration 0.5 seconds at 11,025 samples per second.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">UncorrelatedUniformNoise</span>

<span class="n">signal</span> <span class="o">=</span> <span class="n">UncorrelatedUniformNoise</span><span class="p">()</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">11025</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">make_audio</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>If you play this wave, it sounds like the static you hear if you tune a radio between channels.
The following figure shows what the waveform looks like.
As expected, it looks pretty random.</p>
<p>Here’s what a segment of it looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segment</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">segment</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s take a look at the spectrum:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>In the context of noise it is more conventional to look at the spectrum of power, which is the square of amplitude:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Spectrum.plot_power</span></code> is similar to <code class="docutils literal notranslate"><span class="pre">Spectrum.plot</span></code>, except that it plots power instead of amplitude.
Power is the square of amplitude.
I am switching from amplitude to power in this chapter because it is more conventional in the context of noise.</p>
<p>The following figure shows the result.
Like the signal, the spectrum looks pretty random.
In fact, it <em>is</em> random, but we have to be more precise about the word “random”.
There are at least three things we might like to know about a noise signal or its spectrum:</p>
<ul class="simple">
<li><p>Distribution: The distribution of a random signal is the set of possible values and their probabilities.
For example, in the uniform noise signal, the set of values is the range from -1 to 1, and all values have the same probability.
An alternative is <strong>Gaussian noise</strong>, where the set of values is the range from negative to positive infinity, but values near 0 are the most likely, with probability that drops off according to the Gaussian or “bell” curve.</p></li>
<li><p>Correlation: Is each value in the signal independent of the others, or are there dependencies between them? In UU noise, the values are independent.
An alternative is <strong>Brownian noise</strong>, where each value is the sum of the previous value and a random “step”.
So if the value of the signal is high at a particular point in time, we expect it to stay high, and if it is low, we expect it to stay low.</p></li>
<li><p>Relationship between power and frequency: In the spectrum of UU noise, the power at all frequencies is drawn from the same distribution; that is, the average power is the same for all frequencies.
An alternative is <strong>pink noise</strong>, where power is inversely related to frequency; that is, the power at frequency <span class="math notranslate nohighlight">\(f\)</span> is drawn from a distribution whose mean is proportional to <span class="math notranslate nohighlight">\(1/f\)</span>.</p></li>
</ul>
</section>
<section id="integrated-spectrum">
<span id="section-integrated-spectrum"></span><h2><span class="section-number">4.2. </span>Integrated Spectrum<a class="headerlink" href="#integrated-spectrum" title="Link to this heading">#</a></h2>
<p>For UU noise we can see the relationship between power and frequency more clearly by looking at the <strong>integrated spectrum</strong>, which is a function of frequency, <span class="math notranslate nohighlight">\(f\)</span>, that shows the cumulative power in the spectrum up to <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">Spectrum</span></code> provides a method that computes the IntegratedSpectrum:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_integrated_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">)</span>
    <span class="n">cs</span> <span class="o">/=</span> <span class="n">cs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">IntegratedSpectrum</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">self.power</span></code> is a NumPy array containing power for each frequency.
<code class="docutils literal notranslate"><span class="pre">np.cumsum</span></code> computes the cumulative sum of the powers.
Dividing through by the last element normalizes the integrated spectrum so it runs from 0 to 1.</p>
<p>The result is an IntegratedSpectrum.
Here is the class definition:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">IntegratedSpectrum</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cs</span> <span class="o">=</span> <span class="n">cs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
</pre></div>
</div>
</div>
</div>
<p>Like Spectrum, IntegratedSpectrum provides <code class="docutils literal notranslate"><span class="pre">plot_power</span></code>, so we can compute and plot the integrated spectrum like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integ</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">make_integrated_spectrum</span><span class="p">()</span>
<span class="n">integ</span><span class="o">.</span><span class="n">plot_power</span><span class="p">()</span>
<span class="n">decorate_power</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The result is a straight line, which indicates that power at all frequencies is constant, on average.
Noise with equal power at all frequencies is called <strong>white noise</strong> by analogy with light, because an equal mixture of light at all visible frequencies is white.</p>
<p>UU noise has the same power at all frequencies, on average, which we can confirm by looking at the normalized cumulative sum of power, which I call an integrated spectrum.</p>
<p>A straight line in this figure indicates that UU noise has equal power at all frequencies, on average.  By analogy with light, noise with this property is called “white noise”.</p>
</section>
<section id="brownian-noise">
<span id="section-brownian-noise"></span><h2><span class="section-number">4.3. </span>Brownian Noise<a class="headerlink" href="#brownian-noise" title="Link to this heading">#</a></h2>
<p>UU noise is uncorrelated, which means that each value does not depend on the others.
An alternative is <strong>Brownian noise</strong>, in which each value is the sum of the previous value and a random “step”.</p>
<p>It is called “Brownian” by analogy with Brownian motion, in which a particle suspended in a fluid moves apparently at random, due to unseen interactions with the fluid.
Brownian motion is often described using a <strong>random walk</strong>, which is a mathematical model of a path where the distance between steps is characterized by a random distribution.</p>
<p>In a one-dimensional random walk, the particle moves up or down by a random amount at each time step.
The location of the particle at any point in time is the sum of all previous steps.</p>
<p>This observation suggests a way to generate Brownian noise: generate uncorrelated random steps and then add them up. Here is a class definition that implements this algorithm:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BrownianNoise</span><span class="p">(</span><span class="n">Noise</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="p">):</span>
        <span class="n">dys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dys</span><span class="p">)</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">unbias</span><span class="p">(</span><span class="n">ys</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">amp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ys</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">evaluate</span></code> uses <code class="docutils literal notranslate"><span class="pre">np.random.uniform</span></code> to generate an uncorrelated signal and <code class="docutils literal notranslate"><span class="pre">np.cumsum</span></code> to compute their cumulative sum.</p>
<p>Since the sum is likely to escape the range from -1 to 1, we have to use <code class="docutils literal notranslate"><span class="pre">unbias</span></code> to shift the mean to 0, and <code class="docutils literal notranslate"> <span class="pre">normalize</span></code> to get the desired maximum amplitude.</p>
<p>Here’s the code that generates a BrownianNoise object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">BrownianNoise</span>

<span class="n">signal</span> <span class="o">=</span> <span class="n">BrownianNoise</span><span class="p">()</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">11025</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">make_audio</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The sound is less bright, or more muffled, than white noise.</p>
<p>Here’s what the wave looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The waveform wanders up and down, but there is a clear correlation between successive values.
When the amplitude is high, it tends to stay high, and vice versa.</p>
<p>If you plot the spectrum of Brownian noise on a linear scale, it doesn’t look like much.
Nearly all of the power is at the lowest frequencies; the higher frequency components are not visible.</p>
<p>Here’s what the power spectrum looks like on a linear scale:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>So much of the energy is at low frequencies, we can’t even see the high frequencies.</p>
<p>To see the shape of the spectrum more clearly, we can plot power and frequency on a log-log scale.
Here’s the code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The f=0 component is very small, so on a log scale</span>
<span class="c1"># it&#39;s very negative.  If we clobber it before plotting,</span>
<span class="c1"># we can see the rest of the spectrum more clearly.</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">hs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">loglog</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">(</span><span class="o">**</span><span class="n">loglog</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now the relationship between power and frequency is clearer.  The slope of this line is approximately -2, which indicates that <span class="math notranslate nohighlight">\(P = K / f^2\)</span>, for some constant <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>The relationship between power and frequency is noisy, but roughly linear.</p>
<p><code class="docutils literal notranslate"><span class="pre">Spectrum</span></code> provides <code class="docutils literal notranslate"><span class="pre">estimate_slope</span></code>, which uses SciPy to compute a least squares fit to the power spectrum:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#class Spectrum</span>

<span class="k">def</span><span class="w"> </span><span class="nf">estimate_slope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<p>It discards the first component of the spectrum because this component corresponds to <span class="math notranslate nohighlight">\(f=0\)</span>, and <span class="math notranslate nohighlight">\(\log 0\)</span> is undefined.</p>
<p><code class="docutils literal notranslate"><span class="pre">estimate_slope</span></code> returns the result from <code class="docutils literal notranslate"> <span class="pre">scipy.stats.linregress</span></code> which is an object that contains the estimated slope and intercept, coefficient of determination (<span class="math notranslate nohighlight">\(R^2\)</span>), p-value, and standard error.
For our purposes, we only need the slope.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signal</span> <span class="o">=</span> <span class="n">BrownianNoise</span><span class="p">()</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">11025</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">estimate_slope</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">slope</span>
</pre></div>
</div>
</div>
</div>
<p>The estimated slope of the line is closer to -1.8 than -2, for reasons we’ll see later.</p>
<p>For Brownian noise, the slope of the power spectrum is -2 (we’ll see why in Chapter <a class="reference internal" href="#diffint"><span class="xref myst">[diffint]</span></a>{reference-type=“ref” reference=“diffint”}), so we can write this relationship: $<span class="math notranslate nohighlight">\(\log P = k -2 \log f\)</span><span class="math notranslate nohighlight">\( where \)</span>P<span class="math notranslate nohighlight">\( is power, \)</span>f<span class="math notranslate nohighlight">\( is frequency, and \)</span>k<span class="math notranslate nohighlight">\( is the intercept of the line, which is not important for our purposes.
Exponentiating both sides yields: \)</span><span class="math notranslate nohighlight">\(P = K / f^{2}\)</span><span class="math notranslate nohighlight">\( where \)</span>K<span class="math notranslate nohighlight">\( is \)</span>e^k<span class="math notranslate nohighlight">\(, but still not important.
More relevant is that power is proportional to \)</span>1/f^2$, which is characteristic of Brownian noise.</p>
<p>Brownian noise is also called <strong>red noise</strong>, for the same reason that white noise is called “white”.
If you combine visible light with power proportional to <span class="math notranslate nohighlight">\(1/f^2\)</span>, most of the power would be at the low-frequency end of the spectrum, which is red.
Brownian noise is also sometimes called “brown noise”, but I think that’s confusing, so I won’t use it.</p>
</section>
<section id="pink-noise">
<span id="section-pink-noise"></span><h2><span class="section-number">4.4. </span>Pink Noise<a class="headerlink" href="#pink-noise" title="Link to this heading">#</a></h2>
<p>For red noise, the relationship between frequency and power is $<span class="math notranslate nohighlight">\(P = K / f^{2}\)</span><span class="math notranslate nohighlight">\( There is nothing special about the exponent 2. More generally, we can synthesize noise with any exponent, \)</span>\beta$.</p>
<div class="math notranslate nohighlight">
\[P = K / f^{\beta}\]</div>
<p>When <span class="math notranslate nohighlight">\(\beta = 0\)</span>, power is constant at all frequencies, so the result is white noise.
When <span class="math notranslate nohighlight">\(\beta=2\)</span> the result is red noise.</p>
<p>When <span class="math notranslate nohighlight">\(\beta\)</span> is between 0 and 2, the result is between white and red noise, so it is called <strong>pink noise</strong>.</p>
<p>Pink noise is characterized by a parameter, <span class="math notranslate nohighlight">\(\beta\)</span>, usually between 0 and 2.  You can hear the differences below.</p>
<p>With <span class="math notranslate nohighlight">\(\beta=0\)</span>, we get white noise:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">PinkNoise</span>

<span class="n">signal</span> <span class="o">=</span> <span class="n">PinkNoise</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">make_audio</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>With <span class="math notranslate nohighlight">\(\beta=1\)</span>, pink noise has the relationship <span class="math notranslate nohighlight">\(P = K / f\)</span>, which is why it is also called <span class="math notranslate nohighlight">\(1/f\)</span> noise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signal</span> <span class="o">=</span> <span class="n">PinkNoise</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">make_audio</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>With <span class="math notranslate nohighlight">\(\beta=2\)</span>, we get Brownian (aka red) noise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signal</span> <span class="o">=</span> <span class="n">PinkNoise</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">make_audio</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>There are several ways to generate pink noise.
The simplest is to generate white noise and then apply a low-pass filter with the desired exponent.
<code class="docutils literal notranslate"><span class="pre">thinkdsp</span></code> provides a class that represents a pink noise signal:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">PinkNoise</span><span class="p">(</span><span class="n">Noise</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amp</span> <span class="o">=</span> <span class="n">amp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">amp</span></code> is the desired amplitude of the signal.
<code class="docutils literal notranslate"><span class="pre">beta</span></code> is the desired exponent.
<code class="docutils literal notranslate"><span class="pre">PinkNoise</span></code> provides <code class="docutils literal notranslate"><span class="pre">make_wave</span></code>, which generates a Wave.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_wave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">11025</span><span class="p">):</span>
    <span class="n">signal</span> <span class="o">=</span> <span class="n">UncorrelatedUniformNoise</span><span class="p">()</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">framerate</span><span class="p">)</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>

    <span class="n">spectrum</span><span class="o">.</span><span class="n">pink_filter</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>

    <span class="n">wave2</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">make_wave</span><span class="p">()</span>
    <span class="n">wave2</span><span class="o">.</span><span class="n">unbias</span><span class="p">()</span>
    <span class="n">wave2</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wave2</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">duration</span></code> is the length of the wave in seconds.
<code class="docutils literal notranslate"><span class="pre">start</span></code> is the start time of the wave; it is included so that <code class="docutils literal notranslate"><span class="pre">make_wave</span></code> has the same interface for all types of signal, but for random noise, start time is irrelevant.
And <code class="docutils literal notranslate"><span class="pre">framerate</span></code> is the number of samples per second.</p>
<p><code class="docutils literal notranslate"><span class="pre">make_wave</span></code> creates a white noise wave, computes its spectrum, applies a filter with the desired exponent, and then converts the filtered spectrum back to a wave.
Then it unbiases and normalizes the wave.</p>
<p><code class="docutils literal notranslate"><span class="pre">Spectrum</span></code> provides <code class="docutils literal notranslate"><span class="pre">pink_filter</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pink_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">**</span> <span class="p">(</span><span class="n">beta</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">denom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hs</span> <span class="o">/=</span> <span class="n">denom</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pink_filter</span></code> divides each element of the spectrum by <span class="math notranslate nohighlight">\(f^{\beta/2}\)</span>.
Since power is the square of amplitude, this operation divides the power at each component by <span class="math notranslate nohighlight">\(f^\beta\)</span>.
It treats the component at <span class="math notranslate nohighlight">\(f=0\)</span> as a special case, partly to avoid dividing by 0, and partly because this element represents the bias of the signal, which we are going to set to 0 anyway.</p>
<p>The following figure shows the resulting waveform.
Like Brownian noise, it wanders up and down in a way that suggests correlation between successive values, but at least visually, it looks more random.
In the next chapter we will come back to this observation and I will be more precise about what I mean by “correlation” and “more random”.</p>
<p>The following figure shows the power spectrums for white, pink, and red noise on a log-log scale:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">betas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">betas</span><span class="p">:</span>
    <span class="n">signal</span> <span class="o">=</span> <span class="n">thinkdsp</span><span class="o">.</span><span class="n">PinkNoise</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
    <span class="n">spectrum</span><span class="o">.</span><span class="n">hs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;beta=</span><span class="si">{</span><span class="n">beta</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    
<span class="n">loglog</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">(</span><span class="o">**</span><span class="n">loglog</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, the following figure shows a spectrum for white, pink, and red noise on the same log-log scale.
The relationship between the exponent, <span class="math notranslate nohighlight">\(\beta\)</span>, and the slope of the spectrum is apparent in this figure.</p>
</section>
<section id="gaussian-noise">
<span id="section-gaussian-noise"></span><h2><span class="section-number">4.5. </span>Gaussian Noise<a class="headerlink" href="#gaussian-noise" title="Link to this heading">#</a></h2>
<p>We started with uncorrelated uniform (UU) noise and showed that, because its spectrum has equal power at all frequencies, on average, UU noise is white.</p>
<p>But when people talk about “white noise”, they don’t always mean UU noise.
In fact, more often they mean uncorrelated Gaussian (UG) noise.</p>
<p><code class="docutils literal notranslate"><span class="pre">thinkdsp</span></code> provides an implementation of UG noise:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">UncorrelatedGaussianNoise</span><span class="p">(</span><span class="n">Noise</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="p">):</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">amp</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ys</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">np.random.normal</span></code> returns a NumPy array of values from a Gaussian distribution, in this case with mean 0 and standard deviation <code class="docutils literal notranslate"><span class="pre">self.amp</span></code>.
In theory the range of values is from negative to positive infinity, but we expect about 99% of the values to be between -3 and 3.</p>
<p>UG noise is similar in many ways to UU noise.
The spectrum has equal power at all frequencies, on average, so UG is also white.
And it has one other interesting property: the spectrum of UG noise is also UG noise.
More precisely, the real and imaginary parts of the spectrum are uncorrelated Gaussian values.</p>
<p>To test that claim, we can generate the spectrum of UG noise and then generate a “normal probability plot”, which is a graphical way to test whether a distribution is Gaussian.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">UncorrelatedGaussianNoise</span>

<span class="n">signal</span> <span class="o">=</span> <span class="n">UncorrelatedGaussianNoise</span><span class="p">()</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">11025</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">normal_probability_plot</span>

<span class="n">normal_probability_plot</span><span class="p">(</span><span class="n">spectrum</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">normal_probability_plot</span><span class="p">(</span><span class="n">spectrum</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">NormalProbabilityPlot</span></code> is provided by <code class="docutils literal notranslate"><span class="pre">thinkstats2</span></code>, which is included in the repository for this book.
If you are not familiar with normal probability plots, you can read about them in Chapter xxx of <em>Think Stats</em> at <a class="reference external" href="http://thinkstats.com">http://thinkstats.com</a>.</p>
<p>The gray lines show a linear model fit to the data; the dark lines show the data.</p>
<p>A straight line on a normal probability plot indicates that the data come from a Gaussian distribution.
Except for some random variation at the extremes, these lines are straight, which indicates that the spectrum of UG noise is UG noise.</p>
<p>The spectrum of UU noise is also UG noise, at least approximately.
In fact, by the Central Limit Theorem, the spectrum of almost any uncorrelated noise is approximately Gaussian, as long as the distribution has finite mean and standard deviation, and the number of samples is large.</p>
<p>We can use a normal probability plot to test the distribution of the power spectrum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">normal_prob_plot</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">fit_color</span><span class="o">=</span><span class="s1">&#39;0.8&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Makes a normal probability plot with a fitted line.</span>

<span class="sd">    sample: sequence of numbers</span>
<span class="sd">    fit_color: color string for the fitted line</span>
<span class="sd">    options: passed along to Plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">xs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    
    <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    
    <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">fit_ys</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">std</span> <span class="o">*</span> <span class="n">xs</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">fit_ys</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normal_prob_plot</span><span class="p">(</span><span class="n">spectrum</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;real part&#39;</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>A straight line on a normal probability plot indicates that the distribution of the real part of the spectrum is Gaussian.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normal_prob_plot</span><span class="p">(</span><span class="n">spectrum</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;imag part&#39;</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>And so is the imaginary part.</p>
</section>
<section id="exercises">
<h2><span class="section-number">4.6. </span>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="exercise-4-1">
<h3><span class="section-number">4.6.1. </span>Exercise 4.1<a class="headerlink" href="#exercise-4-1" title="Link to this heading">#</a></h3>
<p>``A Soft Murmur’’ is a web site that plays a mixture of natural noise sources, including rain, waves, wind, etc.
At <a class="reference external" href="http://asoftmurmur.com/about/">http://asoftmurmur.com/about/</a> you can find their list of recordings, most of which are at <a class="reference external" href="http://freesound.org">http://freesound.org</a>.</p>
<p>Download a few of these files and compute the spectrum of each signal.
Does the power spectrum look like white noise, pink noise, or Brownian noise?  How does the spectrum vary over time?</p>
<p>I chose a recording of ocean waves.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;https://github.com/AllenDowney/ThinkDSP/raw/master/code/132736__ciccarelli__ocean-waves.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_wave</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">read_wave</span><span class="p">(</span><span class="s1">&#39;132736__ciccarelli__ocean-waves.wav&#39;</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">make_audio</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>I selected a short segment:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segment</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">segment</span><span class="o">.</span><span class="n">make_audio</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>And here’s its spectrum:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">()</span>
<span class="n">decorate_power</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Amplitude drops off with frequency, so this might be red or pink noise.
We can check by looking at the power spectrum on a log-log scale.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">()</span>

<span class="n">loglog</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">(</span><span class="o">**</span><span class="n">loglog</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>This structure, with increasing and then decreasing amplitude, seems to be common in natural noise sources.</p>
<p>Above <span class="math notranslate nohighlight">\(f = 10^3\)</span>, it might be dropping off linearly, but we can’t really tell.</p>
<p>To see how the spectrum changes over time, I’ll select another segment:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segment2</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">segment2</span><span class="o">.</span><span class="n">make_audio</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>And plot the two spectrums:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum2</span> <span class="o">=</span> <span class="n">segment2</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>

<span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">spectrum2</span><span class="o">.</span><span class="n">plot_power</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Here they are again, plotting power on a log-log scale.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">spectrum2</span><span class="o">.</span><span class="n">plot_power</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">(</span><span class="o">**</span><span class="n">loglog</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>So the structure seems to be consistent over time.</p>
<p>We can also look at a spectrogram:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segment</span><span class="o">.</span><span class="n">make_spectrogram</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">high</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">decorate_gram</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Within this segment, the overall amplitude drops off, but the mixture of frequencies seems consistent.</p>
</section>
<section id="exercise-4-1-continued">
<h3><span class="section-number">4.6.2. </span>Exercise 4.1 (continued)<a class="headerlink" href="#exercise-4-1-continued" title="Link to this heading">#</a></h3>
<p>In a noise signal, the mixture of frequencies changes over time.
In the long run, we expect the power at all frequencies to be equal, but in any sample, the power at each frequency is random.</p>
<p>To estimate the long-term average power at each frequency, we can break a long signal into segments, compute the power spectrum for each segment, and then compute the average across the segments.
You can read more about this algorithm at <a class="reference external" href="http://en.wikipedia.org/wiki/Bartlett's_method">http://en.wikipedia.org/wiki/Bartlett’s_method</a>.</p>
<p>Implement Bartlett’s method and use it to estimate the power spectrum for a noise wave.
Hint: look at the implementation of <code class="docutils literal notranslate"><span class="pre">make_spectrogram</span></code>.</p>
<p>Here’s my implementation:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">Spectrum</span>

<span class="k">def</span><span class="w"> </span><span class="nf">bartlett_method</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">seg_length</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">win_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Estimates the power spectrum of a noise wave.</span>
<span class="sd">    </span>
<span class="sd">    wave: Wave</span>
<span class="sd">    seg_length: segment length</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># make a spectrogram and extract the spectrums</span>
    <span class="n">spectro</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrogram</span><span class="p">(</span><span class="n">seg_length</span><span class="p">,</span> <span class="n">win_flag</span><span class="p">)</span>
    <span class="n">spectrums</span> <span class="o">=</span> <span class="n">spectro</span><span class="o">.</span><span class="n">spec_map</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    
    <span class="c1"># extract the power array from each spectrum</span>
    <span class="n">psds</span> <span class="o">=</span> <span class="p">[</span><span class="n">spectrum</span><span class="o">.</span><span class="n">power</span> <span class="k">for</span> <span class="n">spectrum</span> <span class="ow">in</span> <span class="n">spectrums</span><span class="p">]</span>
    
    <span class="c1"># compute the root mean power (which is like an amplitude)</span>
    <span class="n">hs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">psds</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">psds</span><span class="p">))</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">spectrums</span><span class="p">))</span><span class="o">.</span><span class="n">fs</span>
    
    <span class="c1"># make a Spectrum with the mean amplitudes</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">hs</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">wave</span><span class="o">.</span><span class="n">framerate</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">spectrum</span>
</pre></div>
</div>
</div>
</details>
</div>
<p><code class="docutils literal notranslate"><span class="pre">bartlett_method</span></code> makes a spectrogram and extracts <code class="docutils literal notranslate"><span class="pre">spec_map</span></code>, which maps from times to Spectrum objects.
It computes the PSD for each spectrum, adds them up, and puts the results into a Spectrum object.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psd</span> <span class="o">=</span> <span class="n">bartlett_method</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
<span class="n">psd2</span> <span class="o">=</span> <span class="n">bartlett_method</span><span class="p">(</span><span class="n">segment2</span><span class="p">)</span>

<span class="n">psd</span><span class="o">.</span><span class="n">plot_power</span><span class="p">()</span>
<span class="n">psd2</span><span class="o">.</span><span class="n">plot_power</span><span class="p">()</span>

<span class="n">decorate_power</span><span class="p">(</span><span class="o">**</span><span class="n">loglog</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Now we can see the relationship between power and frequency more clearly.
It is not a simple linear relationship, but it is consistent across different segments, even in details like the notches near 5000 Hz, 6000 Hz, and above 10,000 Hz.</p>
</section>
<section id="exercise-4-2">
<h3><span class="section-number">4.6.3. </span>Exercise 4.2<a class="headerlink" href="#exercise-4-2" title="Link to this heading">#</a></h3>
<p>At <a class="reference external" href="https://www.coindesk.com/price/bitcoin">coindesk</a> you can download the daily price of a BitCoin as a CSV file.
Read this file and compute the spectrum of BitCoin prices as a function of time.
Does it resemble white, pink, or Brownian noise?</p>
<p>Here’s how I analyzed it:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;https://github.com/AllenDowney/ThinkDSP/raw/master/code/BTC_USD_2013-10-01_2020-03-26-CoinDesk.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;BTC_USD_2013-10-01_2020-03-26-CoinDesk.csv&#39;</span><span class="p">,</span> 
                 <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Closing Price (USD)&#39;</span><span class="p">]</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">Wave</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">Wave</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">()</span>

<span class="n">loglog</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">(</span><span class="o">**</span><span class="n">loglog</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">estimate_slope</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Red noise should have a slope of -2.  The slope of this PSD is close to 1.7, so it’s hard to say if we should consider it red noise or if we should say it’s a kind of pink noise.</p>
</section>
<section id="exercise-4-3">
<h3><span class="section-number">4.6.4. </span>Exercise 4.3<a class="headerlink" href="#exercise-4-3" title="Link to this heading">#</a></h3>
<p>A Geiger counter is a device that detects radiation.
When an ionizing particle strikes the detector, it outputs a surge of current.
The total output at a point in time can be modeled as uncorrelated Poisson (UP) noise, where each sample is a random quantity from a Poisson distribution, which corresponds to the number of particles detected during an interval.</p>
<p>Write a class called <code class="docutils literal notranslate"><span class="pre">UncorrelatedPoissonNoise</span></code> that inherits from <code class="docutils literal notranslate"> <span class="pre">_Noise</span></code> and provides <code class="docutils literal notranslate"><span class="pre">evaluate</span></code>.
It should use <code class="docutils literal notranslate"><span class="pre">np.random.poisson</span></code> to generate random values from a Poisson distribution.
The parameter of this function, <code class="docutils literal notranslate"><span class="pre">lam</span></code>, is the average number of particles during each interval.
You can use the attribute <code class="docutils literal notranslate"><span class="pre">amp</span></code> to specify <code class="docutils literal notranslate"><span class="pre">lam</span></code>.
For example, if the framerate is 10 kHz and <code class="docutils literal notranslate"><span class="pre">amp</span></code> is 0.001, we expect about 10 “clicks” per second.</p>
<p>Generate about a second of UP noise and listen to it. For low values of <code class="docutils literal notranslate"><span class="pre">amp</span></code>, like 0.001, it should sound like a Geiger counter.
For higher values it should sound like white noise.
Compute and plot the power spectrum to see whether it looks like white noise.</p>
<p>Here’s my implementation:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">Noise</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UncorrelatedPoissonNoise</span><span class="p">(</span><span class="n">Noise</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents uncorrelated Poisson noise.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluates the signal at the given times.</span>

<span class="sd">        ts: float array of times</span>
<span class="sd">        </span>
<span class="sd">        returns: float wave array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amp</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ys</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Here’s what it sounds like at low levels of “radiation”.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amp</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">framerate</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">signal</span> <span class="o">=</span> <span class="n">UncorrelatedPoissonNoise</span><span class="p">(</span><span class="n">amp</span><span class="o">=</span><span class="n">amp</span><span class="p">)</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="n">framerate</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">make_audio</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>To check that things worked, we compare the expected number of particles and the actual number:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expected</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">framerate</span> <span class="o">*</span> <span class="n">duration</span>
<span class="n">actual</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Here’s what the wave looks like:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>And here’s its power spectrum on a log-log scale.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">()</span>

<span class="n">loglog</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">(</span><span class="o">**</span><span class="n">loglog</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Looks like white noise, and the slope is close to 0.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">estimate_slope</span><span class="p">()</span><span class="o">.</span><span class="n">slope</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>With a higher arrival rate, it sounds more like white noise:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amp</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">framerate</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">signal</span> <span class="o">=</span> <span class="n">UncorrelatedPoissonNoise</span><span class="p">(</span><span class="n">amp</span><span class="o">=</span><span class="n">amp</span><span class="p">)</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="n">framerate</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">make_audio</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>It looks more like a signal:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>And the spectrum converges on Gaussian noise.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">normal_prob_plot</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">fit_color</span><span class="o">=</span><span class="s1">&#39;0.8&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Makes a normal probability plot with a fitted line.</span>

<span class="sd">    sample: sequence of numbers</span>
<span class="sd">    fit_color: color string for the fitted line</span>
<span class="sd">    options: passed along to Plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">xs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    
    <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    
    <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">fit_ys</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">std</span> <span class="o">*</span> <span class="n">xs</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">fit_ys</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">hs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">normal_probability_plot</span><span class="p">(</span><span class="n">spectrum</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normal_probability_plot</span><span class="p">(</span><span class="n">spectrum</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;imag&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-4-4">
<h3><span class="section-number">4.6.5. </span>Exercise 4.4<a class="headerlink" href="#exercise-4-4" title="Link to this heading">#</a></h3>
<p>The algorithm in this chapter for generating pink noise is conceptually simple but computationally expensive.
There are more efficient alternatives, like the Voss-McCartney algorithm.
Research this method, implement it, compute the spectrum of the result, and confirm that it has the desired relationship between power and frequency.</p>
<p>The fundamental idea of this algorithm is to add up several sequences of random numbers that get updates at different sampling rates.
The first source should get updated at every time step; the second source every other time step, the third source ever fourth step, and so on.</p>
<p>In the original algorithm, the updates are evenly spaced.
In an alternative proposed at <a class="reference external" href="http://www.firstpr.com.au/dsp/pink-noise/">http://www.firstpr.com.au/dsp/pink-noise/</a>, they are randomly spaced.</p>
<p>My implementation starts with an array with one row per timestep and one column for each of the white noise sources.
Initially, the first row and the first column are random and the rest of the array is Nan.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">))</span>
<span class="n">array</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">ncols</span><span class="p">)</span>
<span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>
<span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The next step is to choose the locations where the random sources change.
If the number of rows is <span class="math notranslate nohighlight">\(n\)</span>, the number of changes in the first column is <span class="math notranslate nohighlight">\(n\)</span>, the number in the second column is <span class="math notranslate nohighlight">\(n/2\)</span> on average, the number in the third column is <span class="math notranslate nohighlight">\(n/4\)</span> on average, etc.</p>
<p>So the total number of changes in the matrix is <span class="math notranslate nohighlight">\(2n\)</span> on average; since <span class="math notranslate nohighlight">\(n\)</span> of those are in the first column, the other <span class="math notranslate nohighlight">\(n\)</span> are in the rest of the matrix.</p>
<p>To place the remaining <span class="math notranslate nohighlight">\(n\)</span> changes, we generate random columns from a geometric distribution with <span class="math notranslate nohighlight">\(p=0.5\)</span>.  If we generate a value out of bounds, we set it to 0 (so the first column gets the extras).</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">nrows</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">geometric</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">cols</span><span class="p">[</span><span class="n">cols</span> <span class="o">&gt;=</span> <span class="n">ncols</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">cols</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Within each column, we choose a random row from a uniform distribution.
Ideally we would choose without replacement, but it is faster and easier to choose with replacement, and I doubt it matters.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">rows</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Now we can put random values at rach of the change points.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">[</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Next we want to do a zero-order hold to fill in the NaNs.
NumPy doesn’t do that, but Pandas does.
So I’ll create a DataFrame:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>And then use <code class="docutils literal notranslate"><span class="pre">fillna</span></code> along the columns.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filled</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ffill</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">filled</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Finally we add up the rows.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="n">filled</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">total</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>If we put the results into a Wave, here’s what it looks like:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span> <span class="o">=</span> <span class="n">Wave</span><span class="p">(</span><span class="n">total</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Here’s the whole process in a function:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">voss</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates pink noise using the Voss-McCartney algorithm.</span>
<span class="sd">    </span>
<span class="sd">    nrows: number of values to generate</span>
<span class="sd">    rcols: number of random sources to add</span>
<span class="sd">    </span>
<span class="sd">    returns: NumPy array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="n">array</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">ncols</span><span class="p">)</span>
    <span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>
    
    <span class="c1"># the total number of changes is nrows</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">nrows</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">geometric</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">cols</span><span class="p">[</span><span class="n">cols</span> <span class="o">&gt;=</span> <span class="n">ncols</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="n">array</span><span class="p">[</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">ffill</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">total</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>To test it I’ll generate 11025 values:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span> <span class="o">=</span> <span class="n">voss</span><span class="p">(</span><span class="mi">11025</span><span class="p">)</span>
<span class="n">ys</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>And make them into a Wave:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span> <span class="o">=</span> <span class="n">Wave</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">unbias</span><span class="p">()</span>
<span class="n">wave</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Here’s what it looks like:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>As expected, it is more random-walk-like than white noise, but more random looking than red noise.</p>
<p>Here’s what it sounds like:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">make_audio</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>And here’s the power spectrum:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">hs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">()</span>

<span class="n">loglog</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">(</span><span class="o">**</span><span class="n">loglog</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The estimated slope is close to -1.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">estimate_slope</span><span class="p">()</span><span class="o">.</span><span class="n">slope</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>We can get a better sense of the average power spectrum by generating a longer sample:</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seg_length</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">*</span> <span class="mi">1024</span>
<span class="n">iters</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">Wave</span><span class="p">(</span><span class="n">voss</span><span class="p">(</span><span class="n">seg_length</span> <span class="o">*</span> <span class="n">iters</span><span class="p">))</span>
<span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>And using Barlett’s method to compute the average.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">bartlett_method</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">seg_length</span><span class="o">=</span><span class="n">seg_length</span><span class="p">,</span> <span class="n">win_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">hs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>It’s pretty close to a straight line, with some curvature at the highest frequencies.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">plot_power</span><span class="p">()</span>

<span class="n">loglog</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">decorate_power</span><span class="p">(</span><span class="o">**</span><span class="n">loglog</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>And the slope is close to -1.</p>
<div class="cell tag_solution tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">estimate_slope</span><span class="p">()</span><span class="o">.</span><span class="n">slope</span>
</pre></div>
</div>
</div>
</details>
</div>
<p><a class="reference external" href="https://allendowney.github.io/ThinkDSP2/index.html">Think DSP: Digital Signal Processing in Python, 2nd Edition</a></p>
<p>Copyright 2024 <a class="reference external" href="https://allendowney.com">Allen B. Downey</a></p>
<p>License: <a class="reference external" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chap03.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Non-Periodic Signals</p>
      </div>
    </a>
    <a class="right-next"
       href="chap05.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Autocorrelation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#uncorrelated-noise">4.1. Uncorrelated Noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrated-spectrum">4.2. Integrated Spectrum</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brownian-noise">4.3. Brownian Noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pink-noise">4.4. Pink Noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-noise">4.5. Gaussian Noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">4.6. Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-1">4.6.1. Exercise 4.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-1-continued">4.6.2. Exercise 4.1 (continued)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-2">4.6.3. Exercise 4.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-3">4.6.4. Exercise 4.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-4">4.6.5. Exercise 4.4</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Allen B. Downey
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>