
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>11. Modulation and Sampling &#8212; Think DSP 2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap11';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cacophony for the whole family" href="cacophony.html" />
    <link rel="prev" title="10. LTI Systems" href="chap10.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Think DSP 2</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    ThinkDSP
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Front Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chap00.html">Preface</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chap01.html">1. Sounds and signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap02.html">2. Harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">3. Non-Periodic Signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap04.html">4. Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap05.html">5. Autocorrelation</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap06.html">6. Discrete Cosine Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">7. Discrete Fourier Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap08.html">8. Filtering and Convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap09.html">9. Differentiation and Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap10.html">10. LTI Systems</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">11. Modulation and Sampling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cacophony.html">Cacophony for the whole family</a></li>
<li class="toctree-l1"><a class="reference internal" href="dft_example.html">Implementing DFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourth_wave.html">In Search of the Fourth Wave</a></li>
<li class="toctree-l1"><a class="reference internal" href="phase.html">ThinkDSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="pink_noise.html">Generating Pink Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="saxophone.html">ThinkDSP</a></li>

<li class="toctree-l1"><a class="reference internal" href="voss.html">ThinkDSP</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/AllenDowney/ThinkDSP2/tree/main" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chap11.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modulation and Sampling</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convolution-with-impulses">11.1. Convolution With Impulses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#amplitude-modulation">11.2. Amplitude Modulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling">11.3. Sampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aliasing">11.4. Aliasing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolation">11.5. Interpolation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">11.6. Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-1">11.6.1. Exercise 11.1</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>The second edition of <em>Think DSP</em> is not for sale yet, but if you would like to support this project, you can <a class="reference external" href="https://buymeacoffee.com/allendowney">buy me a coffee</a>.</p>
<p><a class="reference external" href="https://colab.research.google.com/github/AllenDowney/ThinkDSP2/blob/main/soln/chap11.ipynb">Click here to run this notebook on Colab</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">importlib</span><span class="o">,</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s2">&quot;imp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">importlib</span>

<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell tag_remove-print docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download thinkdsp.py</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">basename</span><span class="p">,</span> <span class="n">exists</span>

<span class="k">def</span><span class="w"> </span><span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">urllib.request</span><span class="w"> </span><span class="kn">import</span> <span class="n">urlretrieve</span>
        <span class="n">local</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Downloaded &#39;</span> <span class="o">+</span> <span class="n">local</span><span class="p">)</span>
        
<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkDSP2/raw/main/soln/thinkdsp.py&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell tag_remove-print docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">thinkdsp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">decorate</span><span class="p">,</span> <span class="n">decorate_time</span><span class="p">,</span> <span class="n">decorate_freq</span><span class="p">,</span> <span class="n">decorate_corr</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="modulation-and-sampling">
<span id="chapter-modulation-and-sampling"></span><h1><span class="section-number">11. </span>Modulation and Sampling<a class="headerlink" href="#modulation-and-sampling" title="Link to this heading">#</a></h1>
<p>In Section xxx we saw that when a signal is sampled at 10,000 Hz, a component at 5500 Hz is indistinguishable from a component at 4500 Hz.
In this example, the folding frequency, 5000 Hz, is half of the sampling rate.
But I didn’t explain why.</p>
<p>This chapter explores the effect of sampling and presents the Sampling Theorem, which explains aliasing and the folding frequency.</p>
<p>I’ll start by exploring the effect of convolution with impulses; then I’ll use that effect to explain amplitude modulation (AM), which turns out to be useful for understanding the Sampling Theorem.</p>
<div class="cell tag_hide-cell tag_remove-print docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download thinkdsp.py</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">basename</span><span class="p">,</span> <span class="n">exists</span>

<span class="k">def</span><span class="w"> </span><span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">urllib.request</span><span class="w"> </span><span class="kn">import</span> <span class="n">urlretrieve</span>
        <span class="n">local</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Downloaded &#39;</span> <span class="o">+</span> <span class="n">local</span><span class="p">)</span>
        
<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkDSP/raw/v2/nb/thinkdsp.py&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell tag_remove-print docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">thinkdsp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">decorate</span><span class="p">,</span> <span class="n">decorate_time</span><span class="p">,</span> <span class="n">decorate_freq</span><span class="p">,</span> <span class="n">decorate_corr</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="convolution-with-impulses">
<span id="section-convolution-with-impulses"></span><h2><span class="section-number">11.1. </span>Convolution With Impulses<a class="headerlink" href="#convolution-with-impulses" title="Link to this heading">#</a></h2>
<p>As we saw in Section xxx, convolution of a signal with a series of impulses has the effect of making shifted, scaled copies of the signal.</p>
<p>As an example, I’ll read signal that sounds like a beep:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;https://github.com/AllenDowney/ThinkDSP/raw/v2/soln/253887__themusicalnomad__positive-beeps.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_wave</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;253887__themusicalnomad__positive-beeps.wav&#39;</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">read_wave</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>And I’ll construct a wave with four impulses:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">Impulses</span>

<span class="n">imp_sig</span> <span class="o">=</span> <span class="n">Impulses</span><span class="p">([</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">],</span>
                       <span class="n">amps</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span>     <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="n">impulses</span> <span class="o">=</span> <span class="n">imp_sig</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                             <span class="n">framerate</span><span class="o">=</span><span class="n">wave</span><span class="o">.</span><span class="n">framerate</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And then convolve them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">convolved</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">impulses</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The following figure shows the results, with the signal in the top left, the impulses in the lower left, and the result on the right.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/21ad26171ab64a720e8f9399ffd20853691491d4df43838fedb423ff18c879ae.png" src="_images/21ad26171ab64a720e8f9399ffd20853691491d4df43838fedb423ff18c879ae.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">impulses</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/94409d5c8f95ac25978ed3fb80911e5431efc350eb4ff4722812da54a4a6c1c2.png" src="_images/94409d5c8f95ac25978ed3fb80911e5431efc350eb4ff4722812da54a4a6c1c2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">convolved</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">impulses</span><span class="p">)</span>

<span class="n">convolved</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/527a261bfe9bd82db5ddf017ddc3dedadfdd3bb367d78186a8a93d8be968f7dd.png" src="_images/527a261bfe9bd82db5ddf017ddc3dedadfdd3bb367d78186a8a93d8be968f7dd.png" />
</div>
</div>
<p>You can hear the result in <code class="docutils literal notranslate"><span class="pre">chap11.ipynb</span></code>; it sounds like a series of four beeps with decreasing loudness.</p>
<p>The point of this example is just to demonstrate that convolution with impulses makes shifted, scaled copies.
This result will be useful in the next section.</p>
</section>
<section id="amplitude-modulation">
<span id="section-amplitude-modulation"></span><h2><span class="section-number">11.2. </span>Amplitude Modulation<a class="headerlink" href="#amplitude-modulation" title="Link to this heading">#</a></h2>
<p>Amplitude modulation (AM) is used to broadcast AM radio, among other applications.
At the transmitter, the signal (which might contain speech, music, etc.) is “modulated” by multiplying it with a cosine signal that acts as a “carrier wave”.
The result is a high-frequency wave that is suitable for broadcast by radio.
Typical frequencies for AM radio in the United States are 500–1600 kHz (see <a class="reference external" href="https://en.wikipedia.org/wiki/AM_broadcasting">https://en.wikipedia.org/wiki/AM_broadcasting</a>).</p>
<p>At the receiving end, the broadcast signal is “demodulated” to recover the original signal.
Surprisingly, demodulation works by multiplying the broadcast signal, again, by the same carrier wave.</p>
<p>To see how that works, I’ll modulate a signal with a carrier wave at 10 kHz.
Here’s the signal:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;https://github.com/AllenDowney/ThinkDSP/raw/v2/soln/105977__wcfl10__favorite-station.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;105977__wcfl10__favorite-station.wav&#39;</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">read_wave</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">unbias</span><span class="p">()</span>
<span class="n">wave</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>And here’s the carrier:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">CosSignal</span>

<span class="n">carrier_sig</span> <span class="o">=</span> <span class="n">CosSignal</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">carrier_wave</span> <span class="o">=</span> <span class="n">carrier_sig</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="n">wave</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span>
                                     <span class="n">framerate</span><span class="o">=</span><span class="n">wave</span><span class="o">.</span><span class="n">framerate</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can multiply them using the operator, which multiplies the wave arrays elementwise:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modulated</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">*</span> <span class="n">carrier_wave</span>
</pre></div>
</div>
</div>
</div>
<p>The result sounds pretty bad.
You can hear it in <code class="docutils literal notranslate"><span class="pre">chap11.ipynb</span></code>.</p>
<p>The following figure shows what’s happening in the frequency domain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
<span class="n">modulated</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;modulated&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f3cc1c6b644a05f099043eedf44e9fce0605bf3e9ff75f2be024f7074e11667c.png" src="_images/f3cc1c6b644a05f099043eedf44e9fce0605bf3e9ff75f2be024f7074e11667c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modulated</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;modulated&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/51f0727b42db8f5f650ecca9307d6299f3351cc42ba7118f827afe772205e8ae.png" src="_images/51f0727b42db8f5f650ecca9307d6299f3351cc42ba7118f827afe772205e8ae.png" />
</div>
</div>
<p>The top row is the spectrum of the original signal.
The next row is the spectrum of the modulated signal, after multiplying by the carrier.
It contains two copies of the original spectrum, shifted by plus and minus 10 kHz.</p>
<p>To understand why, recall that convolution in the time domain corresponds to multiplication in the frequency domain.
Conversely, multiplication in the time domain corresponds to convolution in the frequency domain.
When we multiply the signal by the carrier, we are convolving its spectrum with the DFT of the carrier.</p>
<p>Since the carrier is a simple cosine wave, its DFT is two impulses, at plus and minus 10 kHz.
Convolution with these impulses makes shifted, scaled copies of the spectrum.
Notice that the amplitude of the spectrum is smaller after modulation.
The energy from the original signal is split between the copies.</p>
<p>We demodulate the signal, by multiplying by the carrier wave again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">demodulated</span> <span class="o">=</span> <span class="n">modulated</span> <span class="o">*</span> <span class="n">carrier_wave</span>
</pre></div>
</div>
</div>
</div>
<p>The following figure shows the result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">demodulated_spectrum</span> <span class="o">=</span> <span class="n">demodulated</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">demodulated_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;demodulated&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2a933bdcd4a31d9a814504de5a562d13557c8fdc5331be5713af94b510c6e35f.png" src="_images/2a933bdcd4a31d9a814504de5a562d13557c8fdc5331be5713af94b510c6e35f.png" />
</div>
</div>
<p>Again, multiplication in the time domain corresponds to convolution in the frequency domain, which makes shifted, scaled copies of the spectrum.</p>
<p>Since the modulated spectrum contains two peaks, each peak gets split in half and shifted by plus and minus 20 kHz.
Two of the copies meet at 0 kHz and get added together; the other two copies end up centered at plus and minus 20 kHz.</p>
<p>If you listen to the demodulated signal, it sounds pretty good.
The extra copies of the spectrum add high frequency components that were not it the original signal, but they are so high that your speakers probably can’t play them, and most people can’t hear them.
But if you have good speakers and good ears, you might.</p>
<p>In that case, you can get rid of the extra components by applying a low-pass filter:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">demodulated_spectrum</span> <span class="o">=</span> <span class="n">demodulated</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">demodulated_spectrum</span><span class="o">.</span><span class="n">low_pass</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">demodulated_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ef9eaa94a2f7af1508dd98b131af72dc833ab078aeacbe90218c079e1fa4758f.png" src="_images/ef9eaa94a2f7af1508dd98b131af72dc833ab078aeacbe90218c079e1fa4758f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filtered</span> <span class="o">=</span> <span class="n">demodulated_spectrum</span><span class="o">.</span><span class="n">make_wave</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">filtered</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/193199e3dee41ffee08bd3b93a4bf5ba1960a260660e513a6f3d5d79aa4c01fd.png" src="_images/193199e3dee41ffee08bd3b93a4bf5ba1960a260660e513a6f3d5d79aa4c01fd.png" />
</div>
</div>
<p>The result is quite close to the original wave, although about half of the power is lost after demodulating and filtering.
But that’s not a problem in practice, because much more of the power is lost in transmitting and receiving the broadcast signal.
We have to amplify the result anyway, another factor of 2 is not an issue.</p>
</section>
<section id="sampling">
<span id="section-sampling"></span><h2><span class="section-number">11.3. </span>Sampling<a class="headerlink" href="#sampling" title="Link to this heading">#</a></h2>
<p>I explained amplitude modulation in part because it is interesting, but mostly because it will help us understand sampling.
“Sampling” is the process of measuring an analog signal at a series of points in time, usually with equal spacing.</p>
<p>For example, the WAV files we have used as examples were recorded by sampling the output of a microphone using an analog-to-digital converter (ADC).
The sampling rate for most of them is 44.1 kHz, which is the standard rate for “CD quality” sound, or 48 kHz, which is the standard for DVD sound.</p>
<p>At 48 kHz, the folding frequency is 24 kHz, which is higher than most people can hear (see <a class="reference external" href="https://en.wikipedia.org/wiki/Hearing_range">https://en.wikipedia.org/wiki/Hearing_range</a>).</p>
<p>In most of these waves, each sample has 16 bits, so there are <span class="math notranslate nohighlight">\(2^{16}\)</span> distinct levels.
This “bit depth” turns out to be enough that adding more bits does not improve the sound quality noticeably (see <a class="reference external" href="https://en.wikipedia.org/wiki/Digital_audio">https://en.wikipedia.org/wiki/Digital_audio</a>).</p>
<p>Of course, applications other than audio signals might require higher sampling rates, in order to capture higher frequencies, or higher bit-depth, in order to reproduce waveforms with more fidelity.</p>
<p>To demonstrate the effect of the sampling process, I am going to start with a wave sampled at 44.1 kHz and select samples from it at about 11 kHz.
This is not exactly the same as sampling from an analog signal, but the effect is the same.</p>
<p>First I’ll load a recording of a drum solo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;https://github.com/AllenDowney/ThinkDSP/raw/v2/soln/263868__kevcio__amen-break-a-160-bpm.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;263868__kevcio__amen-break-a-160-bpm.wav&#39;</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">read_wave</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The following figure shows the spectrum of this wave.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5078bdb20ecf0bc8f964f8704a5dab3f648225d8c5c38396d3d7889699e51df1.png" src="_images/5078bdb20ecf0bc8f964f8704a5dab3f648225d8c5c38396d3d7889699e51df1.png" />
</div>
</div>
<p>Now here’s the function that samples from the wave:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">Wave</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulates sampling of a wave.</span>
<span class="sd">    </span>
<span class="sd">    wave: Wave object</span>
<span class="sd">    factor: ratio of the new framerate to the original</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">))</span>
    <span class="n">ys</span><span class="p">[::</span><span class="n">factor</span><span class="p">]</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">ys</span><span class="p">[::</span><span class="n">factor</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Wave</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="n">wave</span><span class="o">.</span><span class="n">framerate</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>I’ll use it to select every fourth element:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampled</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The result has the same framerate as the original, but most of the elements are zero.
If you play the sampled wave, it doesn’t sound very good.
The sampling process introduces high-frequency components that were not in the original.</p>
<p>The following figure shows the spectrum of the sampled wave.
It contains four copies of the original spectrum (it looks like five copies because one is split between the highest and lowest frequencies).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampled</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;sampled&#39;</span><span class="p">)</span>

<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/55728bf233d152c5e85e39faa31079b6869bcccf888843e8d4571e8c6730ba68.png" src="_images/55728bf233d152c5e85e39faa31079b6869bcccf888843e8d4571e8c6730ba68.png" />
</div>
</div>
<p>To understand where these copies come from, we can think of the sampling process as multiplication with a series of impulses.
Instead of using <code class="docutils literal notranslate"><span class="pre">sample</span></code> to select every fourth element, we could use this function to make a series of impulses, sometimes called an <strong>impulse train</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_impulses</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make an impulse train for sampling.</span>
<span class="sd">    </span>
<span class="sd">    wave: Wave object</span>
<span class="sd">    factor: spacing between impulses</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">))</span>
    <span class="n">ys</span><span class="p">[::</span><span class="n">factor</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">))</span> <span class="o">/</span> <span class="n">wave</span><span class="o">.</span><span class="n">framerate</span>
    <span class="k">return</span> <span class="n">Wave</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">wave</span><span class="o">.</span><span class="n">framerate</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And then multiply the original wave by the impulse train:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">impulses</span> <span class="o">=</span> <span class="n">make_impulses</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">sampled</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">*</span> <span class="n">impulses</span>
</pre></div>
</div>
</div>
</div>
<p>The result is the same; it still doesn’t sound very good, but now we understand why.
Multiplication in the time domain corresponds to convolution in the frequency domain.
When we multiply by an impulse train, we are convolving with the DFT of an impulse train.
As it turns out, the DFT of an impulse train is also an impulse train.</p>
<p>The following figure shows two examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">show_impulses</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show the impulse train and its spectrum.</span>
<span class="sd">    </span>
<span class="sd">    wave: Wave object</span>
<span class="sd">    factor: spacing between impulses</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">impulses</span> <span class="o">=</span> <span class="n">make_impulses</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
    <span class="n">impulses</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span><span class="o">.</span><span class="n">plot_vlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">xfactor</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">decorate_time</span><span class="p">()</span>
    
    <span class="n">impulses</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_impulses</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b620dcb88f6aba5a5b8fe827aec7ad9e4eaaec72275a990834bdacedbc80238f.png" src="_images/b620dcb88f6aba5a5b8fe827aec7ad9e4eaaec72275a990834bdacedbc80238f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_impulses</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/605aff78c6e2ca71cbab0ed0f4ffce301df5f11db70d281daaa2f3f97ccd6bf9.png" src="_images/605aff78c6e2ca71cbab0ed0f4ffce301df5f11db70d281daaa2f3f97ccd6bf9.png" />
</div>
</div>
<p>The top row is the impulse train in the example, with frequency 11,025 Hz.
The DFT is a train of 4 impulses, which is why we get 4 copies of the spectrum.
The bottom row shows an impulse train with a lower frequency, about 5512 Hz.
Its DFT is a train of 8 impulses.
In general, more impulses in the time domain correspond to fewer impulses in the frequency domain.</p>
<p>In summary:</p>
<ul class="simple">
<li><p>We can think of sampling as multiplication by an impulse train.</p></li>
<li><p>Multiplying by an impulse train corresponds to convolution with an impulse train in the frequency domain.</p></li>
<li><p>Convolution with an impulse train makes multiple copies of the signal’s spectrum.</p></li>
</ul>
</section>
<section id="aliasing">
<span id="section-aliasing"></span><h2><span class="section-number">11.4. </span>Aliasing<a class="headerlink" href="#aliasing" title="Link to this heading">#</a></h2>
<p>Section <a class="reference internal" href="#am"><span class="xref myst">[am]</span></a>{reference-type=“ref” reference=“am”}, after demodulating an AM signal we got rid of the extra copies of the spectrum by applying a low-pass filter.
We can do the same thing after sampling, but it turns out not to be a perfect solution.</p>
<p>The following figure shows why not.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5078bdb20ecf0bc8f964f8704a5dab3f648225d8c5c38396d3d7889699e51df1.png" src="_images/5078bdb20ecf0bc8f964f8704a5dab3f648225d8c5c38396d3d7889699e51df1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">impulses</span> <span class="o">=</span> <span class="n">make_impulses</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">impulses</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;impulses&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/90dfd1c8a503fcaa9c6964b26df0eb23a008ab65dad81ce78df18b837916a182.png" src="_images/90dfd1c8a503fcaa9c6964b26df0eb23a008ab65dad81ce78df18b837916a182.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampled</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">*</span> <span class="n">impulses</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">sampled</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;sampled&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/55728bf233d152c5e85e39faa31079b6869bcccf888843e8d4571e8c6730ba68.png" src="_images/55728bf233d152c5e85e39faa31079b6869bcccf888843e8d4571e8c6730ba68.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">low_pass</span><span class="p">(</span><span class="mf">5512.5</span><span class="p">)</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1fa0bf5391a40f31a5bd624836a11d4cbb36bf924be481fa9fbe03aff245f3a4.png" src="_images/1fa0bf5391a40f31a5bd624836a11d4cbb36bf924be481fa9fbe03aff245f3a4.png" />
</div>
</div>
<p>The top row is the spectrum of the drum solo.
It contains high frequency components that extend past 10 kHz.
When we sample this wave, we convolve the spectrum with the impulse train (second row), which makes copies of the spectrum (third row).
The bottom row shows the result after applying a low-pass filter with a cutoff at the folding frequency, 5512 Hz.</p>
<p>If we convert the result back to a wave, it is similar to the original wave, but there are two problems:</p>
<ul class="simple">
<li><p>Because of the low-pass filter, the components above 5500 Hz have been lost, so the result sounds muted.</p></li>
<li><p>Even the components below 5500 Hz are not quite right, because the include contributions from leftover from the spectral copies we tried to filter out.</p></li>
</ul>
<p>If the spectral copies overlap after sampling, we lose information about the spectrum, and we won’t be able to recover it.</p>
<p>But if the copies don’t overlap, things work out pretty well.
As a second example, I loaded a recording of a bass guitar solo.</p>
<p>The following figure shows its spectrum (top row), which contains no visible energy above 5512 Hz. The second row shows the spectrum of the sampled wave, and the third row shows the spectrum after the low pass filter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;https://github.com/AllenDowney/ThinkDSP/raw/v2/soln/328878__tzurkan__guitar-phrase-tzu.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span> <span class="o">=</span> <span class="n">read_wave</span><span class="p">(</span><span class="s1">&#39;328878__tzurkan__guitar-phrase-tzu.wav&#39;</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d1cdca9a1026345325a5c4fafdd9be4dc874cc4ee230b194a188ffa78d4574a6.png" src="_images/d1cdca9a1026345325a5c4fafdd9be4dc874cc4ee230b194a188ffa78d4574a6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">impulses</span> <span class="o">=</span> <span class="n">make_impulses</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">sampled</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">*</span> <span class="n">impulses</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">sampled</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;sampled&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5ac85c86bad84b703b986219131ae92f6f0e0a1424d49d8e8e50544551137e74.png" src="_images/5ac85c86bad84b703b986219131ae92f6f0e0a1424d49d8e8e50544551137e74.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">low_pass</span><span class="p">(</span><span class="mf">5512.5</span><span class="p">)</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered&#39;</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8a0d27d9f0d49ffd28a7151fb5b51f3a5527fef870f7ceeb3c2841add9711a1b.png" src="_images/8a0d27d9f0d49ffd28a7151fb5b51f3a5527fef870f7ceeb3c2841add9711a1b.png" />
</div>
</div>
<p>The amplitude is lower because we’ve filtered out some of the energy, but the shape of the spectrum is almost exactly what we started with.
And if we convert back to a wave, it sounds the same.</p>
</section>
<section id="interpolation">
<span id="section-interpolation"></span><h2><span class="section-number">11.5. </span>Interpolation<a class="headerlink" href="#interpolation" title="Link to this heading">#</a></h2>
<p>The low pass filter I used in the last step is a so-called <strong>brick wall filter</strong>; frequencies above the cutoff are removed completely, as if they hit a brick wall.</p>
<p>The following figure shows what this filter looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">Spectrum</span>

<span class="k">def</span><span class="w"> </span><span class="nf">make_boxcar</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Makes a boxcar filter for the given spectrum.</span>
<span class="sd">    </span>
<span class="sd">    spectrum: Spectrum to be filtered</span>
<span class="sd">    factor: sampling factor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">spectrum</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">hs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">spectrum</span><span class="o">.</span><span class="n">hs</span><span class="p">)</span>
    
    <span class="n">cutoff</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">framerate</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">factor</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">:</span>
            <span class="n">hs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">hs</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">framerate</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="n">spectrum</span><span class="o">.</span><span class="n">full</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">factor</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">short</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>

<span class="n">sampled</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="n">short</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>

<span class="n">spectrum</span> <span class="o">=</span> <span class="n">sampled</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">boxcar</span> <span class="o">=</span> <span class="n">make_boxcar</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>

<span class="n">sinc</span> <span class="o">=</span> <span class="n">boxcar</span><span class="o">.</span><span class="n">make_wave</span><span class="p">()</span>
<span class="n">sinc</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">sampled</span><span class="o">.</span><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sinc</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sinc</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>

<span class="n">sinc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/19fc60c8b439c4b6d36a7c275911ea8a9b8e28e994895f355d90852f702c856f.png" src="_images/19fc60c8b439c4b6d36a7c275911ea8a9b8e28e994895f355d90852f702c856f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boxcar</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6cf89f2aa6a85ec5822f606af8961c02f87c3299c8103db9963352daecf0abe3.png" src="_images/6cf89f2aa6a85ec5822f606af8961c02f87c3299c8103db9963352daecf0abe3.png" />
</div>
</div>
<p>Of course, multiplication by this filter, in the frequency domain, corresponds to convolution with a window in the time domain.
We can find out what that window is by computing the inverse DFT of the filter, which is shown in the following figure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_sinc_demo</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot sinc interpolation demonstration.</span>
<span class="sd">    </span>
<span class="sd">    wave: Wave object</span>
<span class="sd">    factor: sampling factor</span>
<span class="sd">    start: start time for segment (optional)</span>
<span class="sd">    duration: duration of segment (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_sinc</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Makes a shifted, scaled copy of the sinc function.&quot;&quot;&quot;</span>
        <span class="n">sinc</span> <span class="o">=</span> <span class="n">boxcar</span><span class="o">.</span><span class="n">make_wave</span><span class="p">()</span>
        <span class="n">sinc</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">sinc</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">sinc</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="n">factor</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sinc</span>
 
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_mini_sincs</span><span class="p">(</span><span class="n">wave</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots sinc functions for each sample in wave.&quot;&quot;&quot;</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">),</span> <span class="n">factor</span><span class="p">):</span>
            <span class="n">sinc</span> <span class="o">=</span> <span class="n">make_sinc</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">wave</span><span class="o">.</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">seg</span> <span class="o">=</span> <span class="n">sinc</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
            <span class="n">seg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">total</span> <span class="o">=</span> <span class="n">sinc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="n">sinc</span>
            
        <span class="n">seg</span> <span class="o">=</span> <span class="n">total</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>        
        <span class="n">seg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">sampled</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">sampled</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
    <span class="n">boxcar</span> <span class="o">=</span> <span class="n">make_boxcar</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">start</span> <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">start</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">duration</span> <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">duration</span>
        
    <span class="n">sampled</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span><span class="o">.</span><span class="n">plot_vlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">wave</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">plot_mini_sincs</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>That function has a name; it is the normalized sinc function, or at least a discrete approximation of it (see <a class="reference external" href="https://en.wikipedia.org/wiki/Sinc_function">https://en.wikipedia.org/wiki/Sinc_function</a>):</p>
<div class="math notranslate nohighlight">
\[\mathrm{sinc}(x) = \frac{\sin \pi x}{\pi x}\]</div>
<p>When we apply the low-pass filter, we are convolving with a sinc function.
We can think of this convolution as the sum of shifted, scaled copies of the sinc function.</p>
<p>The value of sinc is 1 at 0 and 0 at every other integer value of <span class="math notranslate nohighlight">\(x\)</span>.
When we shift the sinc function, we move the zero point.
When we scale it, we change the height at the zero point.
So when we add up the shifted, scaled copies, they interpolate between the sampled points.</p>
<p>The following figure shows how that works using a short segment of the bass guitar solo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">short</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="mf">0.004</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mf">0.00061</span>
<span class="n">plot_sinc_demo</span><span class="p">(</span><span class="n">short</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e53008f48b6dd8dee5c92b492f20571b7b5fe18c2056ba1f0fda576eb5a044c7.png" src="_images/e53008f48b6dd8dee5c92b492f20571b7b5fe18c2056ba1f0fda576eb5a044c7.png" />
</div>
</div>
<p>The line across the top is the original wave.
The vertical gray lines show the sampled values.
The thin curves are the shifted, scaled copies of the sinc function.
The sum of these sinc functions is identical to the original wave.</p>
<p>Read that last sentence again, because it is more surprising than it might seem.
Because we started with a signal that contained no energy above 5512 Hz, and we sampled at 11,025 Hz, we were able to recover the original spectrum exactly.</p>
<p>In this example, I started with a wave that had already been sampled at 44,100 Hz, and I resampled it at 11,025 Hz. After resampling, the gap between the spectral copies is the sampling rate, 11.025 kHz.
If the original signal contains components that exceed half of the sampling rate, 5512 Hz, the copies overlap and we lose information.</p>
<p>But if the signal is “bandwidth limited”; that is, it contains no energy above 5512 Hz, the spectral copies don’t overlap, we don’t lose information, and we can recover the original signal exactly.</p>
<p>This result is known as the Nyquist-Shannon sampling theorem (see <a class="reference external" href="https://en.wikipedia.org/wiki/Nyquist-Shannon_sampling_theorem">https://en.wikipedia.org/wiki/Nyquist-Shannon_sampling_theorem</a>).</p>
<p>This example does not prove the Sampling Theorem, but I hope it helps you understand what it says and why it works.</p>
<p>Notice that the argument I made does not depend on the original sampling rate, 44.1 kHz.
The result would be the same if the original had been sampled at a higher frequency, or even if the original had been a continuous analog signal: if we sample at framerate <span class="math notranslate nohighlight">\(f\)</span>, we can recover the original signal exactly, as long as it contains no energy at frequencies above <span class="math notranslate nohighlight">\(f/2\)</span>.</p>
<p>Chris “Monty” Montgomery has an excellent video called “D/A and A/D | Digital Show and Tell”; it demonstrates the Sampling Theorem in action, and presents lots of other excellent information about sampling.
Watch it at <a class="reference external" href="https://www.youtube.com/watch?v=cIQ9IXSUzuM">https://www.youtube.com/watch?v=cIQ9IXSUzuM</a>.</p>
</section>
<section id="exercises">
<h2><span class="section-number">11.6. </span>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="exercise-11-1">
<h3><span class="section-number">11.6.1. </span>Exercise 11.1<a class="headerlink" href="#exercise-11-1" title="Link to this heading">#</a></h3>
<p>As we have seen, if you sample a signal at too low a framerate, frequencies above the folding frequency get aliased.
Once that happens, it is no longer possible to filter out these components, because they are indistinguishable from lower frequencies.</p>
<p>It is a good idea to filter out these frequencies <em>before</em> sampling; a low-pass filter used for this purpose is called an “anti-aliasing filter”.</p>
<p>Returning to the drum solo example, apply a low-pass filter before sampling, then apply the low-pass filter again to remove the spectral copies introduced by sampling.
The result should be identical to the filtered signal.</p>
<div class="cell tag_remove-print docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span> <span class="o">=</span> <span class="n">read_wave</span><span class="p">(</span><span class="s1">&#39;263868__kevcio__amen-break-a-160-bpm.wav&#39;</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="n">wave</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ab2c02153a3a2e12307e0dccd33301f2cb180f659936d1655a5862e31005b32e.png" src="_images/ab2c02153a3a2e12307e0dccd33301f2cb180f659936d1655a5862e31005b32e.png" />
</div>
</div>
<p>This signal is sampled at 44100 Hz.  Here’s what it sounds like.</p>
<p>And here’s the spectrum:</p>
<p>I’ll reduce the sampling rate by a factor of 3 (but you can change this to try other values):</p>
<p>Before sampling we apply an anti-aliasing filter to remove frequencies above the new folding frequency, which is <code class="docutils literal notranslate"><span class="pre">framerate/2</span></code>:</p>
<p>Here’s what it sounds like after filtering (still pretty good).</p>
<p>Here’s the function that simulates the sampling process:</p>
<p>The result contains copies of the spectrum near 20 kHz; they are not very noticeable:</p>
<p>But they show up when we plot the spectrum:</p>
<p>We can get rid of the spectral copies by applying the anti-aliasing filter again:</p>
<p>We just lost half the energy in the spectrum, but we can scale the result to get it back:</p>
<p>Now the difference between the spectrum before and after sampling should be small.</p>
<p>After filtering and scaling, we can convert back to a wave:</p>
<p>And the difference between the interpolated wave and the filtered wave should be small.</p>
<p><a class="reference external" href="https://allendowney.github.io/ThinkDSP2/index.html">Think DSP: Digital Signal Processing in Python, 2nd Edition</a></p>
<p>Copyright 2024 <a class="reference external" href="https://allendowney.com">Allen B. Downey</a></p>
<p>License: <a class="reference external" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chap10.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">10. </span>LTI Systems</p>
      </div>
    </a>
    <a class="right-next"
       href="cacophony.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Cacophony for the whole family</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convolution-with-impulses">11.1. Convolution With Impulses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#amplitude-modulation">11.2. Amplitude Modulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling">11.3. Sampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aliasing">11.4. Aliasing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolation">11.5. Interpolation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">11.6. Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-1">11.6.1. Exercise 11.1</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Allen B. Downey
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>