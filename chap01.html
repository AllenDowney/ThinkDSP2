
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. Sounds and signals &#8212; Think DSP 2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap01';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Harmonics" href="chap02.html" />
    <link rel="prev" title="Preface" href="chap00.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Think DSP 2</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    ThinkDSP
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Front Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chap00.html">Preface</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">1. Sounds and signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap02.html">2. Harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">3. Non-Periodic Signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap04.html">4. Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap05.html">5. Autocorrelation</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap06.html">6. Discrete Cosine Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">7. Discrete Fourier Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap08.html">8. Filtering and Convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap09.html">9. Differentiation and Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap10.html">10. LTI Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap11.html">11. Modulation and Sampling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cacophony.html">Cacophony for the whole family</a></li>
<li class="toctree-l1"><a class="reference internal" href="dft_example.html">Implementing DFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourth_wave.html">In Search of the Fourth Wave</a></li>
<li class="toctree-l1"><a class="reference internal" href="phase.html">ThinkDSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="pink_noise.html">Generating Pink Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="saxophone.html">ThinkDSP</a></li>

<li class="toctree-l1"><a class="reference internal" href="voss.html">ThinkDSP</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/AllenDowney/ThinkDSP2/tree/main" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chap01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sounds and signals</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#periodic-signals">1.1. Periodic Signals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-decomposition">1.2. Spectral Decomposition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#signals">1.3. Signals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-and-writing-waves">1.4. Reading and Writing Waves</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectrums">1.5. Spectrums</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wave-objects">1.6. Wave Objects</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#signal-objects">1.7. Signal Objects</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">1.8. Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-1">1.8.1. Exercise 1.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-2">1.8.2. Exercise 1.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-3">1.8.3. Exercise 1.3</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>The second edition of <em>Think DSP</em> is not for sale yet, but if you would like to support this project, you can <a class="reference external" href="https://buymeacoffee.com/allendowney">buy me a coffee</a>.</p>
<section id="sounds-and-signals">
<span id="chapter-sounds-and-signals"></span><h1><span class="section-number">1. </span>Sounds and signals<a class="headerlink" href="#sounds-and-signals" title="Link to this heading">#</a></h1>
<p>A <strong>signal</strong> represents a quantity that varies in time.
That definition is pretty abstract, so let’s start with a concrete example: sound.
Sound is variation in air pressure.
A sound signal represents variations in air pressure over time.</p>
<p>A microphone is a device that measures these variations and generates an electrical signal that represents sound.
A speaker is a device that takes an electrical signal and produces sound.
Microphones and speakers are called <strong>transducers</strong> because they transduce, or convert, signals from one form to another.</p>
<p>This book is about signal processing, which includes processes for synthesizing, transforming, and analyzing signals.
I will focus on sound signals, but the same methods apply to electronic signals, mechanical vibration, and signals in many other domains.</p>
<p>They also apply to signals that vary in space rather than time, like elevation along a hiking trail.
And they apply to signals in more than one dimension, like an image, which you can think of as a signal that varies in two-dimensional space.
Or a movie, which is a signal that varies in two-dimensional space <em>and</em> time.</p>
<p>But we’ll start with one-dimensional sound.</p>
<p><a class="reference external" href="https://colab.research.google.com/github/AllenDowney/ThinkDSP2/blob/main/soln/chap01.ipynb">Click here to run this notebook on Colab</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">importlib</span><span class="o">,</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s2">&quot;imp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">importlib</span>

<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell tag_remove-print docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download thinkdsp.py</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">basename</span><span class="p">,</span> <span class="n">exists</span>

<span class="k">def</span><span class="w"> </span><span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">urllib.request</span><span class="w"> </span><span class="kn">import</span> <span class="n">urlretrieve</span>
        <span class="n">local</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Downloaded &#39;</span> <span class="o">+</span> <span class="n">local</span><span class="p">)</span>
        
<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkDSP2/raw/main/soln/thinkdsp.py&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell tag_remove-print docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">thinkdsp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">decorate</span><span class="p">,</span> <span class="n">decorate_time</span><span class="p">,</span> <span class="n">decorate_freq</span>

<span class="c1"># Define PI2 for use in signal definitions</span>
<span class="n">PI2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="periodic-signals">
<span id="section-periodic-signals"></span><h2><span class="section-number">1.1. </span>Periodic Signals<a class="headerlink" href="#periodic-signals" title="Link to this heading">#</a></h2>
<p>We’ll start with <strong>periodic signals</strong>, which are signals that repeat themselves after some period of time.
For example, if you strike a bell, it vibrates and generates sound.
If you record that sound and plot the transduced signal, it looks like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;https://github.com/AllenDowney/ThinkDSP/raw/master/code/18871__zippi1__sound-bell-440hz.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span> <span class="o">=</span> <span class="n">thinkdsp</span><span class="o">.</span><span class="n">read_wave</span><span class="p">(</span><span class="s1">&#39;18871__zippi1__sound-bell-440hz.wav&#39;</span><span class="p">)</span>

<span class="n">start</span><span class="o">=</span><span class="mf">7.0</span>
<span class="n">duration</span><span class="o">=</span><span class="mf">0.006835</span>
<span class="n">segment</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="n">segment</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>

<span class="n">segment</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fe499e1a6475205e488163de3d041588536f24b5ada69e6acc85bd73b2e6c44d.png" src="_images/fe499e1a6475205e488163de3d041588536f24b5ada69e6acc85bd73b2e6c44d.png" />
</div>
</div>
<p>This signal resembles a <strong>sinusoid</strong>, which means it has the same shape as the trigonometric sine function.</p>
<p>You can see that this signal is periodic.
I chose the duration to show three full repetitions, also known as <strong>cycles</strong>.
The duration of each cycle, called the <strong>period</strong>, is about 2.3 ms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">period</span> <span class="o">=</span> <span class="n">duration</span> <span class="o">/</span> <span class="mi">3</span>
<span class="n">period</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.002278333333333333
</pre></div>
</div>
</div>
</div>
<p>The <strong>frequency</strong> of a signal is the number of cycles per second, which is the inverse of the period.
The units of frequency are cycles per second, or <strong>Hertz</strong>, abbreviated “Hz”.
(Strictly speaking, the number of cycles is a dimensionless number, so a Hertz is really a “per second”).</p>
<p>The frequency of this signal is about 439 Hz, slightly lower than 440 Hz, which is the standard tuning pitch for orchestral music.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">period</span>
<span class="n">freq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>438.9173372348208
</pre></div>
</div>
</div>
</div>
<p>The musical name of this note is A, or more specifically, A4. If you are not familiar with “scientific pitch notation”, the numerical suffix indicates which octave the note is in. A4 is the A above middle C. A5 is one octave higher.
See <a class="reference external" href="http://en.wikipedia.org/wiki/Scientific_pitch_notation">http://en.wikipedia.org/wiki/Scientific_pitch_notation</a>.</p>
<p>A tuning fork generates a sinusoid because the vibration of the tines is a form of simple harmonic motion.
Most musical instruments produce periodic signals, but the shape of these signals is not sinusoidal.
For example, the following figure shows a segment from a recording of a violin playing Boccherini’s String Quintet No. 5 in E, 3rd movement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;https://github.com/AllenDowney/ThinkDSP/raw/master/code/92002__jcveliz__violin-origional.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span><span class="o">=</span><span class="mf">1.30245</span>
<span class="n">duration</span><span class="o">=</span><span class="mf">0.00683</span>
    
<span class="n">wave</span> <span class="o">=</span> <span class="n">thinkdsp</span><span class="o">.</span><span class="n">read_wave</span><span class="p">(</span><span class="s1">&#39;92002__jcveliz__violin-origional.wav&#39;</span><span class="p">)</span>

<span class="n">segment</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="n">segment</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>

<span class="n">segment</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/db35ff99768f7aa5fab48131a19af27c7f2026cd543a974f71e2769c4dc34d8b.png" src="_images/db35ff99768f7aa5fab48131a19af27c7f2026cd543a974f71e2769c4dc34d8b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">period</span> <span class="o">=</span> <span class="n">duration</span> <span class="o">/</span> <span class="mi">3</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">period</span>
<span class="n">period</span><span class="p">,</span> <span class="n">freq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.002276666666666667, 439.2386530014641)
</pre></div>
</div>
</div>
</div>
<p>Again we can see that the signal is periodic, but the shape of the signal is more complex.
The shape of a periodic signal is called the <strong>waveform</strong>.
Most musical instruments produce waveforms more complex than a sinusoid.
The shape of the waveform determines the musical <strong>timbre</strong>, which is our perception of the quality of the sound.
People usually perceive complex waveforms as richer and more interesting than sinusoids.</p>
</section>
<section id="spectral-decomposition">
<span id="section-spectral-decomposition"></span><h2><span class="section-number">1.2. </span>Spectral Decomposition<a class="headerlink" href="#spectral-decomposition" title="Link to this heading">#</a></h2>
<p>The most important topic in this book is <strong>spectral decomposition</strong>, which is the idea that any signal can be expressed as the sum of sinusoids with different frequencies.</p>
<p>The most important mathematical idea in this book is the <strong>discrete Fourier transform</strong>, or <strong>DFT</strong>, which takes a signal and produces its <strong>spectrum</strong>.
The spectrum is the set of sinusoids that add up to produce the signal.</p>
<p>And the most important algorithm in this book is the <strong>Fast Fourier transform</strong>, or <strong>FFT</strong>, which is an efficient way to compute the DFT.</p>
<p>For example, the following figure shows the spectrum of the violin recording .
The x-axis is the range of frequencies that make up the signal.
The y-axis shows the strength or <strong>amplitude</strong> of each frequency component.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>

<span class="n">spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">high</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">decorate_freq</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c7ad2302cb30cd2b6420e57fd275bc89ca1b6362db433b3e060919304adf7790.png" src="_images/c7ad2302cb30cd2b6420e57fd275bc89ca1b6362db433b3e060919304adf7790.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">peaks</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">peaks</span><span class="p">()</span>
<span class="k">for</span> <span class="n">amp</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">peaks</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">amp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>879.0697674418604 76.17798540516124
439.5348837209302 59.16347454326548
2197.6744186046512 40.697348728269354
1758.139534883721 27.88382731887038
1318.6046511627906 19.52617537056222
3516.279069767442 19.37602333377786
3955.813953488372 14.738082832263192
4395.3488372093025 9.949495002349357
2637.209302325581 8.699626332652446
4834.883720930233 6.25857412248801
</pre></div>
</div>
</div>
</div>
<p>The lowest frequency component is called the <strong>fundamental frequency</strong>.
The fundamental frequency of this signal is near 440 Hz (actually a little lower, or “flat”).</p>
<p>In this signal the fundamental frequency has the largest amplitude, so it is also the <strong>dominant frequency</strong>.
Normally the perceived pitch of a sound is determined by the fundamental frequency, even if it is not dominant.</p>
<p>The other spikes in the spectrum are at frequencies 880, 1320, 1760, and 2200, which are integer multiples of the fundamental.
These components are called <strong>harmonics</strong> because they are musically harmonious with the fundamental:</p>
<ul class="simple">
<li><p>880 is the frequency of A5, one octave higher than the fundamental.
An <strong>octave</strong> is a doubling in frequency.</p></li>
<li><p>1320 is approximately E6, which is a perfect fifth above A5. If you are not familiar with musical intervals like “perfect fifth”, see <a class="reference external" href="https://en.wikipedia.org/wiki/Interval_(music)">https://en.wikipedia.org/wiki/Interval_(music)</a>.</p></li>
<li><p>1760 is A6, two octaves above the fundamental.</p></li>
<li><p>2200 is approximately C<span class="math notranslate nohighlight">\(\sharp\)</span>7, which is a major third above A6.</p></li>
</ul>
<p>These harmonics make up the notes of an A major chord, although not all in the same octave.
Some of them are only approximate because the notes that make up Western music have been adjusted for <strong>equal temperament</strong> (see <a class="reference external" href="http://en.wikipedia.org/wiki/Equal_temperament">http://en.wikipedia.org/wiki/Equal_temperament</a>).</p>
<p>Given the harmonics and their amplitudes, you can reconstruct the signal by adding up sinusoids.
Next we’ll see how.</p>
</section>
<section id="signals">
<span id="section-signals"></span><h2><span class="section-number">1.3. </span>Signals<a class="headerlink" href="#signals" title="Link to this heading">#</a></h2>
<p>I wrote a Python module called <code class="docutils literal notranslate"><span class="pre">thinkdsp.py</span></code> that contains classes and functions for working with signals and spectrums[^1].
You will find it in the repository for this book (see Section <a class="reference internal" href="#code"><span class="xref myst">[code]</span></a>{reference-type=“ref” reference=“code”}).</p>
<p>To represent signals, <code class="docutils literal notranslate"><span class="pre">thinkdsp</span></code> provides a class called <code class="docutils literal notranslate"><span class="pre">Signal</span></code>, which is the parent class for several signal types, including <code class="docutils literal notranslate"><span class="pre">Sinusoid</span></code>, which represents both sine and cosine signals.</p>
<p><code class="docutils literal notranslate"><span class="pre">thinkdsp</span></code> provides functions to create sine and cosine signals:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cos_sig</span> <span class="o">=</span> <span class="n">thinkdsp</span><span class="o">.</span><span class="n">CosSignal</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mi">440</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sin_sig</span> <span class="o">=</span> <span class="n">thinkdsp</span><span class="o">.</span><span class="n">SinSignal</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mi">880</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">freq</span></code> is frequency in Hz. <code class="docutils literal notranslate"><span class="pre">amp</span></code> is amplitude in unspecified units where 1.0 is defined as the largest amplitude we can record or play back.</p>
<p><code class="docutils literal notranslate"><span class="pre">offset</span></code> is a <strong>phase offset</strong> in radians.
Phase offset determines where in the period the signal starts.
For example, a sine signal with <code class="docutils literal notranslate"><span class="pre">offset=0</span></code> starts at <span class="math notranslate nohighlight">\(\sin 0\)</span>, which is 0. With <code class="docutils literal notranslate"><span class="pre">offset=pi/2</span></code> it starts at <span class="math notranslate nohighlight">\(\sin \pi/2\)</span>, which is 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cos_sig</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">sin_sig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_periods</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e157ac3267a328e015f0f52108918e93112acf018456a21bdff4b0463aa68a08.png" src="_images/e157ac3267a328e015f0f52108918e93112acf018456a21bdff4b0463aa68a08.png" />
</div>
</div>
<p>Signals have an <code class="docutils literal notranslate"><span class="pre">__add__</span></code> method, so you can use the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator to add them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix</span> <span class="o">=</span> <span class="n">sin_sig</span> <span class="o">+</span> <span class="n">cos_sig</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b967932771a6e6afe28f850e6006746e9d8a0dae227081b71e5d30f4df62f700.png" src="_images/b967932771a6e6afe28f850e6006746e9d8a0dae227081b71e5d30f4df62f700.png" />
</div>
</div>
<p>The result is a <code class="docutils literal notranslate"><span class="pre">SumSignal</span></code>, which represents the sum of two or more signals.</p>
<p>A Signal is basically a Python representation of a mathematical function.
Most signals are defined for all values of <code class="docutils literal notranslate"><span class="pre">t</span></code>, from negative infinity to infinity.</p>
<p>You can’t do much with a Signal until you evaluate it. In this context, “evaluate” means taking a sequence of points in time, <code class="docutils literal notranslate"> <span class="pre">ts</span></code>, and computing the corresponding values of the signal, <code class="docutils literal notranslate"><span class="pre">ys</span></code>.
I represent <code class="docutils literal notranslate"><span class="pre">ts</span></code> and <code class="docutils literal notranslate"><span class="pre">ys</span></code> using NumPy arrays and encapsulate them in an object called a Wave.</p>
<p>A Wave represents a signal evaluated at a sequence of points in time.
Each point in time is called a <strong>frame</strong> (a term borrowed from movies and video).
The measurement itself is called a <strong>sample</strong>, although “frame” and “sample” are sometimes used interchangeably.</p>
<p><code class="docutils literal notranslate"><span class="pre">Signal</span></code> provides <code class="docutils literal notranslate"><span class="pre">make_wave</span></code>, which returns a new Wave object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span> <span class="o">=</span> <span class="n">mix</span><span class="o">.</span><span class="n">make_wave</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">11025</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">duration</span></code> is the length of the Wave in seconds.
<code class="docutils literal notranslate"><span class="pre">start</span></code> is the start time, also in seconds.
<code class="docutils literal notranslate"><span class="pre">framerate</span></code> is the (integer) number of frames per second, which is also the number of samples per second.</p>
<p>11,025 frames per second is one of several framerates commonly used in audio file formats, including Waveform Audio File (WAV) and mp3.</p>
<p>This example evaluates the signal from <code class="docutils literal notranslate"><span class="pre">t=0</span></code> to <code class="docutils literal notranslate"><span class="pre">t=0.5</span></code> at 5,513 equally-spaced frames (because 5,513 is half of 11,025).
The time between frames, or <strong>timestep</strong>, is <code class="docutils literal notranslate"><span class="pre">1/11025</span></code> seconds, about 91 <span class="math notranslate nohighlight">\(\mu\)</span>s.</p>
<p><code class="docutils literal notranslate"><span class="pre">Wave</span></code> provides a <code class="docutils literal notranslate"><span class="pre">plot</span></code> method that …</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Audio</span>
<span class="n">audio</span> <span class="o">=</span> <span class="n">Audio</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">wave</span><span class="o">.</span><span class="n">ys</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">wave</span><span class="o">.</span><span class="n">framerate</span><span class="p">)</span>
<span class="n">audio</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
                <audio  controls="controls" >
                    <source src="data:audio/wav;base64,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" type="audio/wav" />
                    Your browser does not support the audio element.
                </audio>
              </div></div>
</div>
<p>At <code class="docutils literal notranslate"><span class="pre">freq=440</span></code> there are 220 periods in 0.5 seconds, so this plot would look like a solid block of color.
To zoom in on a small number of periods, we can use <code class="docutils literal notranslate"><span class="pre">segment</span></code>, which copies a segment of a Wave and returns a new wave:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">period</span> <span class="o">=</span> <span class="n">mix</span><span class="o">.</span><span class="n">period</span>
<span class="n">segment</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">period</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">period</span></code> is a property of a Signal; it returns the period in seconds.</p>
<p><code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">duration</span></code> are in seconds.
This example copies the first three periods from <code class="docutils literal notranslate"><span class="pre">mix</span></code>.
The result is a Wave object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segment</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_time</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b967932771a6e6afe28f850e6006746e9d8a0dae227081b71e5d30f4df62f700.png" src="_images/b967932771a6e6afe28f850e6006746e9d8a0dae227081b71e5d30f4df62f700.png" />
</div>
</div>
<p>This signal contains two frequency components, so it is more complicated than the signal from the tuning fork, but less complicated than the violin.</p>
</section>
<section id="reading-and-writing-waves">
<span id="section-reading-and-writing-waves"></span><h2><span class="section-number">1.4. </span>Reading and Writing Waves<a class="headerlink" href="#reading-and-writing-waves" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">thinkdsp</span></code> provides <code class="docutils literal notranslate"><span class="pre">read_wave</span></code>, which reads a WAV file and returns a Wave:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span> <span class="o">=</span> <span class="n">thinkdsp</span><span class="o">.</span><span class="n">read_wave</span><span class="p">(</span><span class="s1">&#39;92002__jcveliz__violin-origional.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And <code class="docutils literal notranslate"><span class="pre">Wave</span></code> provides <code class="docutils literal notranslate"><span class="pre">write</span></code>, which writes a WAV file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;output.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing output.wav
</pre></div>
</div>
</div>
</div>
<p>You can listen to the Wave with any media player that plays WAV files.
On UNIX systems, I use <code class="docutils literal notranslate"><span class="pre">aplay</span></code>, which is simple, robust, and included in many Linux distributions.</p>
<p><code class="docutils literal notranslate"><span class="pre">thinkdsp</span></code> also provides <code class="docutils literal notranslate"><span class="pre">play_wave</span></code>, which runs the media player as a subprocess:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">thinkdsp</span><span class="o">.</span><span class="n">play_wave</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;output.wav&#39;</span><span class="p">,</span> <span class="n">player</span><span class="o">=</span><span class="s1">&#39;aplay&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Playing WAVE &#39;output.wav&#39; : Signed 16 bit Little Endian, Rate 44100 Hz, Mono
</pre></div>
</div>
</div>
</div>
<p>It uses <code class="docutils literal notranslate"><span class="pre">aplay</span></code> by default, but you can provide the name of another player.</p>
</section>
<section id="spectrums">
<span id="section-spectrums"></span><h2><span class="section-number">1.5. </span>Spectrums<a class="headerlink" href="#spectrums" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Wave</span></code> provides <code class="docutils literal notranslate"><span class="pre">make_spectrum</span></code>, which returns a <code class="docutils literal notranslate"><span class="pre">Spectrum</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">make_spectrum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>And <code class="docutils literal notranslate"><span class="pre">Spectrum</span></code> provides <code class="docutils literal notranslate"><span class="pre">plot</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b92c97ad3000c6209971d35192200bf842043f92d8ffe260298e363c35c9f248.png" src="_images/b92c97ad3000c6209971d35192200bf842043f92d8ffe260298e363c35c9f248.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Spectrum</span></code> provides three methods that modify the spectrum:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">low_pass</span></code> applies a low-pass filter, which means that components above a given cutoff frequency are attenuated (that is, reduced in magnitude) by a factor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">high_pass</span></code> applies a high-pass filter, which means that it attenuates components below the cutoff.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">band_stop</span></code> attenuates components in the band of frequencies between two cutoffs.</p></li>
</ul>
<p>This example attenuates all frequencies above 600 by 99%:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectrum</span><span class="o">.</span><span class="n">low_pass</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>A low pass filter removes bright, high-frequency sounds, so the result sounds muffled and darker.
To hear what it sounds like, you can convert the Spectrum back to a Wave, and then play it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">make_wave</span><span class="p">()</span>
<span class="n">wave</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s1">&#39;temp.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing temp.wav
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Playing WAVE &#39;temp.wav&#39; : Signed 16 bit Little Endian, Rate 44100 Hz, Mono
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">play</span></code> method writes the wave to a file and then plays it. If you use Jupyter notebooks, you can use <code class="docutils literal notranslate"><span class="pre">make_audio</span></code>, which makes an Audio widget that plays the sound.</p>
</section>
<section id="wave-objects">
<span id="section-wave-objects"></span><h2><span class="section-number">1.6. </span>Wave Objects<a class="headerlink" href="#wave-objects" title="Link to this heading">#</a></h2>
<p>There is nothing very complicated in <code class="docutils literal notranslate"><span class="pre">thinkdsp.py</span></code>.
Most of the functions it provides are thin wrappers around functions from NumPy and SciPy.</p>
<p>The primary classes in <code class="docutils literal notranslate"><span class="pre">thinkdsp</span></code> are Signal, Wave, and Spectrum.
Given a Signal, you can make a Wave.
Given a Wave, you can make a Spectrum, and vice versa.
These relationships are shown in this diagram:</p>
<img alt="https://github.com/AllenDowney/ThinkDSP/raw/v2/figs/uml_diagram1.png" src="https://github.com/AllenDowney/ThinkDSP/raw/v2/figs/uml_diagram1.png" />
<p>A Wave object contains three attributes: <code class="docutils literal notranslate"><span class="pre">ys</span></code> is a NumPy array that contains the values in the signal; <code class="docutils literal notranslate"><span class="pre">ts</span></code> is an array of the times where the signal was evaluated or sampled; and <code class="docutils literal notranslate"> <span class="pre">framerate</span></code> is the number of samples per unit of time.
The unit of time is usually seconds, but it doesn’t have to be. In one of my examples, it’s days.</p>
<p>Wave also provides three read-only properties: <code class="docutils literal notranslate"><span class="pre">start</span></code>, <code class="docutils literal notranslate"><span class="pre">end</span></code>, and <code class="docutils literal notranslate"><span class="pre">duration</span></code>.
If you modify <code class="docutils literal notranslate"><span class="pre">ts</span></code>, these properties change accordingly.</p>
<p>To modify a wave, you can access the <code class="docutils literal notranslate"><span class="pre">ts</span></code> and <code class="docutils literal notranslate"><span class="pre">ys</span></code> directly.
For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">ys</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="n">wave</span><span class="o">.</span><span class="n">ts</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>The first line scales the wave by a factor of 2, making it louder.
The second line shifts the wave in time, making it start 1 second later.</p>
<p>But Wave provides methods that perform many common operations.
For example, the same two transformations could be written:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">wave</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You can read the documentation of these methods and others at <a class="reference external" href="http://greenteapress.com/thinkdsp.html">http://greenteapress.com/thinkdsp.html</a>.</p>
</section>
<section id="signal-objects">
<span id="section-signal-objects"></span><h2><span class="section-number">1.7. </span>Signal Objects<a class="headerlink" href="#signal-objects" title="Link to this heading">#</a></h2>
<p>Signal is a parent class that provides functions common to all kinds of signals, like <code class="docutils literal notranslate"><span class="pre">make_wave</span></code>.
Child classes inherit these methods and provide <code class="docutils literal notranslate"><span class="pre">evaluate</span></code>, which evaluates the signal at a given sequence of times.</p>
<p>For example, Sinusoid is a child class of Signal, with this definition:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thinkdsp</span><span class="w"> </span><span class="kn">import</span> <span class="n">Signal</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Sinusoid</span><span class="p">(</span><span class="n">Signal</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">440</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">):</span>
        <span class="n">Signal</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amp</span> <span class="o">=</span> <span class="n">amp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
</pre></div>
</div>
</div>
</div>
<p>The parameters of <code class="docutils literal notranslate"><span class="pre">__init__</span></code> are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">freq</span></code>: frequency in cycles per second, or Hz.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">amp</span></code>: amplitude.
The units of amplitude are arbitrary, usually chosen so 1.0 corresponds to the maximum input from a microphone or maximum output to a speaker.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">offset</span></code>: indicates where in its period the signal starts; <code class="docutils literal notranslate"><span class="pre">offset</span></code> is in units of radians, for reasons I explain below.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code>: a Python function used to evaluate the signal at a particular point in time.
It is usually either <code class="docutils literal notranslate"><span class="pre">np.sin</span></code> or <code class="docutils literal notranslate"><span class="pre">np.cos</span></code>, yielding a sine or cosine signal.</p></li>
</ul>
<p>Like many init methods, this one just tucks the parameters away for future use.</p>
<p>Signal provides <code class="docutils literal notranslate"><span class="pre">make_wave</span></code>, which looks like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_wave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">11025</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">framerate</span><span class="p">)</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">framerate</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Wave</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="n">framerate</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">duration</span></code> are the start time and duration in seconds.
<code class="docutils literal notranslate"><span class="pre">framerate</span></code> is the number of frames (samples) per second.</p>
<p><code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of samples, and <code class="docutils literal notranslate"><span class="pre">ts</span></code> is a NumPy array of sample times.</p>
<p>To compute the <code class="docutils literal notranslate"><span class="pre">ys</span></code>, <code class="docutils literal notranslate"><span class="pre">make_wave</span></code> invokes <code class="docutils literal notranslate"><span class="pre">evaluate</span></code>, which is provided by <code class="docutils literal notranslate"><span class="pre">Sinusoid</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="p">):</span>
    <span class="n">phases</span> <span class="o">=</span> <span class="n">PI2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">*</span> <span class="n">ts</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amp</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">phases</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ys</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s unwind this function one step at time:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.freq</span></code> is frequency in cycles per second, and each element of <code class="docutils literal notranslate"><span class="pre">ts</span></code> is a time in seconds, so their product is the number of cycles since the start time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PI2</span></code> is a constant that stores <span class="math notranslate nohighlight">\(2 \pi\)</span>.
Multiplying by <code class="docutils literal notranslate"><span class="pre">PI2</span></code> converts from cycles to <strong>phase</strong>.
You can think of phase as “cycles since the start time” expressed in radians.
Each cycle is <span class="math notranslate nohighlight">\(2 \pi\)</span> radians.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.offset</span></code> is the phase when <span class="math notranslate nohighlight">\(t\)</span> is <code class="docutils literal notranslate"><span class="pre">ts[0]</span></code>.
It has the effect of shifting the signal left or right in time.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">self.func</span></code> is <code class="docutils literal notranslate"><span class="pre">np.sin</span></code> or <code class="docutils literal notranslate"><span class="pre">np.cos</span></code>, the result is a value between <span class="math notranslate nohighlight">\(-1\)</span> and <span class="math notranslate nohighlight">\(+1\)</span>.</p></li>
<li><p>Multiplying by <code class="docutils literal notranslate"><span class="pre">self.amp</span></code> yields a signal that ranges from <code class="docutils literal notranslate"><span class="pre">-self.amp</span></code> to <code class="docutils literal notranslate"><span class="pre">+self.amp</span></code>.</p></li>
</ol>
<p>In math notation, <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> is written like this: $<span class="math notranslate nohighlight">\(y = A \cos (2 \pi f t + \phi_0)\)</span><span class="math notranslate nohighlight">\( where \)</span>A<span class="math notranslate nohighlight">\( is amplitude, \)</span>f<span class="math notranslate nohighlight">\( is frequency, \)</span>t<span class="math notranslate nohighlight">\( is time, and \)</span>\phi_0$ is the phase offset.
It may seem like I wrote a lot of code to evaluate one simple expression, but as we’ll see, this code provides a framework for dealing with all kinds of signals, not just sinusoids.</p>
</section>
<section id="exercises">
<h2><span class="section-number">1.8. </span>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="exercise-1-1">
<h3><span class="section-number">1.8.1. </span>Exercise 1.1<a class="headerlink" href="#exercise-1-1" title="Link to this heading">#</a></h3>
<p>Go to <a class="reference external" href="http://freesound.org">http://freesound.org</a> and download a sound sample that
includes music, speech, or other sounds that have a well-defined pitch.
Select a roughly half-second segment where the pitch is
constant.  Compute and plot the spectrum of the segment you selected.
What connection can you make between the timbre of the sound and the
harmonic structure you see in the spectrum?</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">high_pass</span></code>, <code class="docutils literal notranslate"><span class="pre">low_pass</span></code>, and <code class="docutils literal notranslate"><span class="pre">band_stop</span></code> to
filter out some of the harmonics.  Then convert the spectrum back
to a wave and listen to it.  How does the sound relate to the
changes you made in the spectrum?</p>
<p>I chose this recording (or synthesis?) of a trumpet section <a class="reference external" href="http://www.freesound.org/people/Dublie/sounds/170255/">http://www.freesound.org/people/Dublie/sounds/170255/</a></p>
<p>As always, thanks to the people who contributed these recordings!</p>
<p>Here’s what the whole wave looks like:</p>
<p>By trial and error, I selected a segment with a constant pitch (although I believe it is a chord played by at least two horns).</p>
<p>Here’s what the segment looks like:</p>
<p>And here’s an even shorter segment so you can see the waveform:</p>
<p>Here’s what the spectrum looks like:</p>
<p>It has lots of frequency components.  Let’s zoom in on the fundamental and dominant frequencies:</p>
<p><code class="docutils literal notranslate"><span class="pre">peaks</span></code> prints the highest points in the spectrum and their frequencies, in descending order:</p>
<p>The dominant peak is at 870 Hz.  It’s not easy to dig out the fundamental, but with peaks at 507, 347, and 253 Hz, we can infer a fundamental at roughly 85 Hz, with harmonics at 170, 255, 340, 425, and 510 Hz.</p>
<p>85 Hz is close to F2 at 87 Hz.  The pitch we perceive is usually the fundamental, even when it is not dominant.  When you listen to this segment, what pitch(es) do you perceive?</p>
<p>Next we can filter out the high frequencies:</p>
<p>And here’s what it sounds like:</p>
<p>The following interaction allows you to select a segment and apply different filters.  If you set the cutoff to 3400 Hz, you can simulate what the sample would sound like over an old (not digital) phone line.</p>
</section>
<section id="exercise-1-2">
<h3><span class="section-number">1.8.2. </span>Exercise 1.2<a class="headerlink" href="#exercise-1-2" title="Link to this heading">#</a></h3>
<p>Synthesize a compound signal by creating SinSignal and CosSignal
objects and adding them up.  Evaluate the signal to get a Wave,
and listen to it.  Compute its Spectrum and plot it.
What happens if you add frequency
components that are not multiples of the fundamental?</p>
<p>Here are some arbitrary components I chose.  It makes an interesting waveform!</p>
<p>We can use the signal to make a wave:</p>
<p>And here’s what it sounds like:</p>
<p>The components are all multiples of 200 Hz, so they make a coherent sounding tone.</p>
<p>Here’s what the spectrum looks like:</p>
<p>If we add a component that is not a multiple of 200 Hz, we hear it as a distinct pitch.</p>
</section>
<section id="exercise-1-3">
<h3><span class="section-number">1.8.3. </span>Exercise 1.3<a class="headerlink" href="#exercise-1-3" title="Link to this heading">#</a></h3>
<p>Write a function called <code class="docutils literal notranslate"><span class="pre">stretch</span></code> that takes a Wave and a stretch factor and speeds up or slows down the wave by modifying <code class="docutils literal notranslate"><span class="pre">ts</span></code> and <code class="docutils literal notranslate"><span class="pre">framerate</span></code>.  Hint: it should only take two lines of code.</p>
<p>I’ll use the trumpet example again:</p>
<p>Here’s my implementation of <code class="docutils literal notranslate"><span class="pre">stretch</span></code></p>
<p>And here’s what it sounds like if we speed it up by a factor of 2.</p>
<p>Here’s what it looks like (to confirm that the <code class="docutils literal notranslate"><span class="pre">ts</span></code> got updated correctly).</p>
<p>I think it sounds better speeded up.  In fact, I wonder if we are playing the original at the right speed.</p>
<p><a class="reference external" href="https://allendowney.github.io/ThinkDSP2/index.html">Think DSP: Digital Signal Processing in Python, 2nd Edition</a></p>
<p>Copyright 2024 <a class="reference external" href="https://allendowney.com">Allen B. Downey</a></p>
<p>License: <a class="reference external" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chap00.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Preface</p>
      </div>
    </a>
    <a class="right-next"
       href="chap02.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Harmonics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#periodic-signals">1.1. Periodic Signals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-decomposition">1.2. Spectral Decomposition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#signals">1.3. Signals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-and-writing-waves">1.4. Reading and Writing Waves</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectrums">1.5. Spectrums</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wave-objects">1.6. Wave Objects</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#signal-objects">1.7. Signal Objects</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">1.8. Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-1">1.8.1. Exercise 1.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-2">1.8.2. Exercise 1.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-3">1.8.3. Exercise 1.3</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Allen B. Downey
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>